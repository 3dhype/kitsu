(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4170de0c"],{c132:function(t,e,s){"use strict";var a=s("d7a9"),i=s.n(a);i.a},d46a:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"asset-types page fixed-page"},[s("div",{staticClass:"asset-type-list-header page-header flexrow"},[s("search-field",{ref:"asset-type-search-field",staticClass:"flexrow-item mt1",attrs:{placeholder:"ex: chars, agent327"},on:{change:t.onSearchChange}}),s("combobox",{staticClass:"mb0 flexrow-item",attrs:{label:t.$t("statistics.display_mode"),"locale-key-prefix":"statistics.",options:t.displayModeOptions},model:{value:t.displayMode,callback:function(e){t.displayMode=e},expression:"displayMode"}}),s("span",{staticClass:"filler"}),s("button-simple",{staticClass:"flexrow-item",attrs:{icon:"download"},on:{click:t.exportStatisticsToCsv}})],1),s("production-asset-type-list",{ref:"asset-type-list",attrs:{entries:t.displayedAssetTypes,"is-loading":t.isAssetsLoading||t.initialLoading,"is-error":t.isAssetsLoadingError,"validation-columns":t.assetValidationColumns,"asset-type-stats":t.assetTypeStats,"display-mode":t.displayMode,"show-all":0===t.assetTypeSearchText.length},on:{scroll:t.saveScrollPosition}})],1)},i=[],n=(s("8e6e"),s("ac6a"),s("456d"),s("7f7f"),s("bd86")),o=s("c1df"),r=s.n(o),l=s("2f62"),c=s("3455"),p=s("8c97"),d=s("de40"),u=s("992f"),y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"data-list"},[s("div",{staticClass:"table-header-wrapper"},[s("table",{ref:"headerWrapper",staticClass:"table table-header"},[s("thead",[s("tr",[s("th",{staticClass:"name"},[t._v(t._s(t.$t("asset_types.fields.name")))]),s("th",{staticClass:"validation"},[t._v(t._s(t.$t("main.all")))]),t._l(t.validationColumns,(function(e){return t.isLoading?t._e():s("th",{key:e,staticClass:"validation",style:t.getValidationStyle(e)},[s("router-link",{attrs:{to:t.taskTypePath(e)}},[t._v("\n              "+t._s(t.taskTypeMap[e].name)+"\n            ")])],1)})),s("th",{staticClass:"actions"})],2)])])]),s("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),!t.isEmptyList||t.isCurrentUserClient||t.isLoading?t._e():s("div",{staticClass:"has-text-centered"},[t._m(0),s("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list")))]),s("button-link",{staticClass:"level-item big-button",attrs:{text:t.$t("assets.new_asset"),path:t.newAssetPath}})],1),t.isEmptyList&&t.isCurrentUserClient&&!t.isLoading?s("div",{staticClass:"has-text-centered"},[t._m(1),s("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list_client")))])]):t._e(),t.isLoading?t._e():s("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.onBodyScroll,expression:"onBodyScroll"}],ref:"body",staticClass:"table-body"},[s("table",{staticClass:"table"},[s("tbody",[t.showAll&&!t.isEmptyList?s("tr",{staticClass:"all-line"},[s("td",{staticClass:"name"},[t._v("\n            "+t._s(t.$t("asset_types.all_asset_types"))+"\n          ")]),s("stats-cell",{attrs:{colors:t.chartColors("all","all"),data:t.chartData("all","all"),displayMode:t.displayMode}}),t._l(t.validationColumns,(function(e){return s("stats-cell",{key:"all-"+e,style:t.getValidationStyle(e),attrs:{colors:t.chartColors("all",e),data:t.chartData("all",e),displayMode:t.displayMode}})})),s("td",{staticClass:"actions"})],2):t._e(),t._l(t.entries,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"name"},[t._v("\n            "+t._s(e.name)+"\n          ")]),t.isStats(e.id,"all")?s("stats-cell",{attrs:{colors:t.chartColors(e.id,"all"),data:t.chartData(e.id,"all"),displayMode:t.displayMode}}):s("td"),t._l(t.validationColumns,(function(a){return t.isStats(e.id,a)?s("stats-cell",{key:e.id+a,style:t.getValidationStyle(a),attrs:{colors:t.chartColors(e.id,a),data:t.chartData(e.id,a),displayMode:t.displayMode}}):s("td",{style:t.getValidationStyle(a)})})),s("td",{staticClass:"actions"})],2)}))],2)])]),t.isEmptyList||t.isLoading?t._e():s("p",{staticClass:"has-text-centered nb-asset-types"},[t._v("\n    "+t._s(t.displayedAssetTypesLength)+"\n    "+t._s(t.$tc("asset_types.number",t.displayedAssetTypesLength))+"\n  ")])],1)},h=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"info"},[a("img",{attrs:{src:s("66a5")}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"info"},[a("img",{attrs:{src:s("66a5")}})])}],f=s("e9c6"),m=s("09d3"),b=s("e211"),S=s("b131"),T=s("e60b");function g(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function v(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?g(s,!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var _={name:"production-asset-type-list",mixins:[f["a"]],props:{displayMode:{type:String,default:"pie"},entries:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},assetTypeStats:{type:Object,default:function(){}},showAll:{type:Boolean,default:!1},validationColumns:{type:Array,default:function(){return[]}}},data:function(){return{busy:!1,lastSelection:null}},components:{ButtonLink:b["a"],StatsCell:S["a"],TableInfo:T["a"]},computed:v({},Object(l["c"])(["assetTypeSearchText","currentEpisode","currentProduction","displayedAssetTypesLength","isCurrentUserClient","isTVShow","taskTypeMap"]),{isEmptyList:function(){return this.entries&&0===this.entries.length&&!this.isLoading&&!this.isError&&(!this.assetTypeSearchText||0===this.assetTypeSearchText.length)},newAssetPath:function(){var t={name:"new-asset",params:{production_id:this.currentProduction.id}};return this.isTVShow&&this.currentEpisode&&(t.name="episode-new-asset",t.params.episode_id=this.currentEpisode.id),t}}),methods:v({},Object(l["b"])([]),{chartColors:function(t,e){return Object(m["b"])(this.assetTypeStats,t,e)},chartData:function(t,e){return Object(m["c"])(this.assetTypeStats,t,e)},isStats:function(t,e){return this.assetTypeStats[t]&&this.assetTypeStats[t][e]},onHeaderScroll:function(t,e){this.$refs.tableWrapper.scrollLeft=e.scrollLeft},onBodyScroll:function(t,e){this.$refs.headerWrapper.style.left="-".concat(e.scrollLeft,"px"),this.$emit("scroll",e.scrollTop)},setScrollPosition:function(t){this.$refs.body&&(this.$refs.body.scrollTop=t)},taskTypePath:function(t){var e={name:"task-type",params:{production_id:this.currentProduction.id,task_type_id:t,type:"assets"}};return this.isTVShow&&this.currentEpisode&&(e.name="episode-task-type",e.params.episode_id=this.currentEpisode.id),e},resizeHeaders:function(){}})},C=_,O=(s("c132"),s("2877")),P=Object(O["a"])(C,y,h,!1,null,"13d335c5",null),L=P.exports,w=s("4d04");function j(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function A(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?j(s,!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):j(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var x={name:"production-asset-types",components:{ButtonSimple:d["a"],Combobox:u["a"],ProductionAssetTypeList:L,SearchField:w["a"]},data:function(){return{initialLoading:!0,displayMode:"pie",displayModeOptions:[{label:"pie",value:"pie"},{label:"count",value:"count"}]}},computed:A({},Object(l["c"])(["assetTypeMap","assetTypePath","assetTypeStats","assetTypeSearchText","assetTypeListScrollPosition","assetValidationColumns","currentEpisode","currentProduction","displayedAssetTypes","isAssetsLoading","isAssetsLoadingError","isTVShow","taskStatusMap","taskTypeMap"])),created:function(){},mounted:function(){var t=this;this.setDefaultSearchText(),this.setDefaultListScrollPosition(),setTimeout((function(){t.initAssetTypes().then(t.handleModalsDisplay).then((function(){t.initialLoading=!1}))}),100)},methods:A({},Object(l["b"])(["computeAssetTypeStats","initAssetTypes","loadAssets","loadComment","setAssetTypeSearch","setAssetTypeListScrollPosition","setLastProductionScreen"]),{setDefaultSearchText:function(){this.assetTypeSearchText.length>0&&this.$refs["asset-type-search-field"].setValue(this.assetTypeSearchText)},setDefaultListScrollPosition:function(){this.$refs["asset-type-list"].setScrollPosition(this.assetTypeListScrollPosition)},navigateToList:function(){this.$router.push(this.assetTypesPath)},onSearchChange:function(t){var e=this.$refs["asset-type-search-field"].getValue();this.setAssetTypeSearch(e)},saveScrollPosition:function(t){this.setAssetTypeListScrollPosition(t)},exportStatisticsToCsv:function(){var t=[r()().format("YYYYMMDD"),this.currentProduction.name,"asset_types","statistics"];this.currentEpisode&&t.splice(2,0,this.currentEpisode.name);var e=Object(p["b"])(t.join("_"));c["a"].generateStatReports(e,this.assetTypeStats,this.taskTypeMap,this.taskStatusMap,this.assetTypeMap,this.countMode)}}),watch:{currentProduction:function(){var t=this;this.$refs["asset-type-search-field"].setValue(""),this.isTVShow||(this.initialLoading=!0,this.loadAssets((function(){t.computeAssetTypeStats(),t.setAssetTypeListScrollPosition(0),t.initialLoading=!1})))},currentEpisode:function(){var t=this;this.isTVShow&&(this.initialLoading=!0,this.$refs["asset-type-search-field"].setValue(""),this.setAssetTypeListScrollPosition(0),this.loadAssets((function(){t.computeAssetTypeStats(),t.initialLoading=!1})))}},socket:{events:{"comment:new":function(t){var e=this,s=t.comment_id;this.loadComment({commentId:s,callback:function(){e.computeAssetTypeStats()}})}}},metaInfo:function(){return{title:"".concat(this.currentProduction.name," | ").concat(this.$t("asset_types.production_title")," - Kitsu")}}},k=x,M=Object(O["a"])(k,a,i,!1,null,"21ac4da4",null);e["default"]=M.exports},d7a9:function(t,e,s){}}]);
//# sourceMappingURL=chunk-4170de0c.692fea25.js.map