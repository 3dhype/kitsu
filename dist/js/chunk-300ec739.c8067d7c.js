(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-300ec739"],{"8b12":function(t,s,e){"use strict";var a=e("ffc9"),i=e.n(a);i.a},d46a:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"asset-types page fixed-page"},[e("div",{staticClass:"asset-type-list-header page-header flexrow"},[e("search-field",{ref:"asset-type-search-field",staticClass:"flexrow-item mt1",attrs:{placeholder:"ex: chars, agent327"},on:{change:t.onSearchChange}}),e("combobox",{staticClass:"mb0 flexrow-item",attrs:{label:t.$t("statistics.display_mode"),"locale-key-prefix":"statistics.",options:t.displayModeOptions},model:{value:t.displayMode,callback:function(s){t.displayMode=s},expression:"displayMode"}}),e("span",{staticClass:"filler"}),e("button-simple",{staticClass:"flexrow-item",attrs:{icon:"download"},on:{click:t.exportStatisticsToCsv}})],1),e("production-asset-type-list",{ref:"asset-type-list",attrs:{entries:t.displayedAssetTypes,"is-loading":t.isAssetsLoading||t.initialLoading,"is-error":t.isAssetsLoadingError,"validation-columns":t.assetValidationColumns,"asset-type-stats":t.assetTypeStats,"display-mode":t.displayMode,"show-all":0===t.assetTypeSearchText.length},on:{scroll:t.saveScrollPosition}})],1)},i=[],o=(e("7f7f"),e("cebc")),n=e("c1df"),l=e.n(n),r=e("2f62"),c=e("3455"),d=e("8c97"),p=e("de40"),u=e("992f"),h=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"data-list"},[e("div",{staticClass:"table-header-wrapper"},[e("table",{ref:"headerWrapper",staticClass:"table table-header"},[e("thead",[e("tr",[e("th",{staticClass:"name"},[t._v(t._s(t.$t("asset_types.fields.name")))]),e("th",{staticClass:"validation"},[t._v(t._s(t.$t("main.all")))]),t._l(t.sortedValidationColumns,function(s){return t.isLoading?t._e():e("th",{key:s,staticClass:"validation",style:t.getValidationStyle(s)},[e("router-link",{attrs:{to:t.taskTypePath(s)}},[t._v("\n              "+t._s(t.taskTypeMap[s].name)+"\n            ")])],1)}),e("th",{staticClass:"actions"})],2)])])]),e("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),!t.isEmptyList||t.isCurrentUserClient||t.isLoading?t._e():e("div",{staticClass:"has-text-centered"},[t._m(0),e("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list")))]),e("button-link",{staticClass:"level-item big-button",attrs:{text:t.$t("assets.new_asset"),path:t.newAssetPath}})],1),t.isEmptyList&&t.isCurrentUserClient&&!t.isLoading?e("div",{staticClass:"has-text-centered"},[t._m(1),e("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list_client")))])]):t._e(),t.isLoading?t._e():e("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.onBodyScroll,expression:"onBodyScroll"}],ref:"body",staticClass:"table-body"},[e("table",{staticClass:"table"},[e("tbody",[t.showAll&&!t.isEmptyList?e("tr",{staticClass:"all-line"},[e("td",{staticClass:"name"},[t._v("\n            "+t._s(t.$t("asset_types.all_asset_types"))+"\n          ")]),e("stats-cell",{attrs:{colors:t.chartColors("all","all"),data:t.chartData("all","all"),displayMode:t.displayMode}}),t._l(t.sortedValidationColumns,function(s){return e("stats-cell",{key:"all-"+s,style:t.getValidationStyle(s),attrs:{colors:t.chartColors("all",s),data:t.chartData("all",s),displayMode:t.displayMode}})}),e("td",{staticClass:"actions"})],2):t._e(),t._l(t.entries,function(s){return e("tr",{key:s.id},[e("td",{staticClass:"name"},[t._v("\n            "+t._s(s.name)+"\n          ")]),t.isStats(s.id,"all")?e("stats-cell",{attrs:{colors:t.chartColors(s.id,"all"),data:t.chartData(s.id,"all"),displayMode:t.displayMode}}):e("td"),t._l(t.sortedValidationColumns,function(a){return t.isStats(s.id,a)?e("stats-cell",{key:s.id+a,style:t.getValidationStyle(a),attrs:{colors:t.chartColors(s.id,a),data:t.chartData(s.id,a),displayMode:t.displayMode}}):e("td",{style:t.getValidationStyle(a)})}),e("td",{staticClass:"actions"})],2)})],2)])]),t.isEmptyList||t.isLoading?t._e():e("p",{staticClass:"has-text-centered nb-asset-types"},[t._v("\n    "+t._s(t.displayedAssetTypesLength)+"\n    "+t._s(t.$tc("asset_types.number",t.displayedAssetTypesLength))+"\n  ")])],1)},y=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",{staticClass:"info"},[a("img",{attrs:{src:e("66a5")}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",{staticClass:"info"},[a("img",{attrs:{src:e("66a5")}})])}],f=(e("ac6a"),e("e9c6")),m=e("09d3"),T=e("e211"),S=e("b131"),_=e("e60b"),b={name:"production-asset-type-list",mixins:[f["a"]],props:{displayMode:{type:String,default:"pie"},entries:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},assetTypeStats:{type:Object,default:function(){}},showAll:{type:Boolean,default:!1},validationColumns:{type:Array,default:function(){return[]}}},data:function(){return{busy:!1,lastSelection:null}},components:{ButtonLink:T["a"],StatsCell:S["a"],TableInfo:_["a"]},computed:Object(o["a"])({},Object(r["c"])(["assetTypeSearchText","currentEpisode","currentProduction","displayedAssetTypesLength","isCurrentUserClient","isTVShow","taskTypeMap"]),{isEmptyList:function(){return this.entries&&0===this.entries.length&&!this.isLoading&&!this.isError&&(!this.assetTypeSearchText||0===this.assetTypeSearchText.length)},newAssetPath:function(){var t={name:"new-asset",params:{production_id:this.currentProduction.id}};return this.isTVShow&&this.currentEpisode&&(t.name="episode-new-asset",t.params.episode_id=this.currentEpisode.id),t}}),methods:Object(o["a"])({},Object(r["b"])([]),{chartColors:function(t,s){return Object(m["b"])(this.assetTypeStats,t,s)},chartData:function(t,s){return Object(m["c"])(this.assetTypeStats,t,s)},isStats:function(t,s){return this.assetTypeStats[t]&&this.assetTypeStats[t][s]},onHeaderScroll:function(t,s){this.$refs.tableWrapper.scrollLeft=s.scrollLeft},onBodyScroll:function(t,s){this.$refs.headerWrapper.style.left="-".concat(s.scrollLeft,"px"),this.$emit("scroll",s.scrollTop)},setScrollPosition:function(t){this.$refs.body&&(this.$refs.body.scrollTop=t)},taskTypePath:function(t){var s={name:"task-type",params:{production_id:this.currentProduction.id,task_type_id:t,type:"assets"}};return this.isTVShow&&this.currentEpisode&&(s.name="episode-task-type",s.params.episode_id=this.currentEpisode.id),s},resizeHeaders:function(){}})},C=b,v=(e("8b12"),e("2877")),g=Object(v["a"])(C,h,y,!1,null,"5980e068",null),L=g.exports,A=e("4d04"),x={name:"production-asset-types",components:{ButtonSimple:p["a"],Combobox:u["a"],ProductionAssetTypeList:L,SearchField:A["a"]},data:function(){return{initialLoading:!0,displayMode:"pie",displayModeOptions:[{label:"pie",value:"pie"},{label:"count",value:"count"}]}},computed:Object(o["a"])({},Object(r["c"])(["assetTypeMap","assetTypePath","assetTypeStats","assetTypeSearchText","assetTypeListScrollPosition","assetValidationColumns","currentEpisode","currentProduction","displayedAssetTypes","isAssetsLoading","isAssetsLoadingError","isTVShow","taskStatusMap","taskTypeMap"])),created:function(){},mounted:function(){var t=this;this.setDefaultSearchText(),this.setDefaultListScrollPosition(),setTimeout(function(){t.initAssetTypes().then(t.handleModalsDisplay).then(function(){t.initialLoading=!1})},100)},methods:Object(o["a"])({},Object(r["b"])(["computeAssetTypeStats","initAssetTypes","loadAssets","loadComment","setAssetTypeSearch","setAssetTypeListScrollPosition","setLastProductionScreen"]),{setDefaultSearchText:function(){this.assetTypeSearchText.length>0&&this.$refs["asset-type-search-field"].setValue(this.assetTypeSearchText)},setDefaultListScrollPosition:function(){this.$refs["asset-type-list"].setScrollPosition(this.assetTypeListScrollPosition)},navigateToList:function(){this.$router.push(this.assetTypesPath)},onSearchChange:function(t){var s=this.$refs["asset-type-search-field"].getValue();this.setAssetTypeSearch(s)},saveScrollPosition:function(t){this.setAssetTypeListScrollPosition(t)},exportStatisticsToCsv:function(){var t=[l()().format("YYYYMMDD"),this.currentProduction.name,"asset_types","statistics"];this.currentEpisode&&t.splice(2,0,this.currentEpisode.name);var s=Object(d["b"])(t.join("_"));c["a"].generateStatReports(s,this.assetTypeStats,this.taskTypeMap,this.taskStatusMap,this.assetTypeMap,this.countMode)}}),watch:{currentProduction:function(){var t=this;this.$refs["asset-type-search-field"].setValue(""),this.isTVShow||(this.initialLoading=!0,this.loadAssets(function(){t.computeAssetTypeStats(),t.setAssetTypeListScrollPosition(0),t.initialLoading=!1}))},currentEpisode:function(){var t=this;this.isTVShow&&(this.initialLoading=!0,this.$refs["asset-type-search-field"].setValue(""),this.setAssetTypeListScrollPosition(0),this.loadAssets(function(){t.computeAssetTypeStats(),t.initialLoading=!1}))}},socket:{events:{"comment:new":function(t){var s=this,e=t.comment_id;this.loadComment({commentId:e,callback:function(){s.computeAssetTypeStats()}})}}},metaInfo:function(){return{title:"".concat(this.currentProduction.name," | ").concat(this.$t("asset_types.production_title")," - Kitsu")}}},w=x,M=Object(v["a"])(w,a,i,!1,null,"21ac4da4",null);s["default"]=M.exports},ffc9:function(t,s,e){}}]);
//# sourceMappingURL=chunk-300ec739.c8067d7c.js.map