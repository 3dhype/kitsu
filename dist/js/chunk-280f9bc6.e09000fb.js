(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-280f9bc6"],{"26a4":function(t,e,s){},"835b":function(t,e,s){"use strict";var a=s("26a4"),i=s.n(a);i.a},d46a:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"asset-types page fixed-page"},[s("div",{staticClass:"asset-type-list-header page-header flexrow"},[s("search-field",{ref:"asset-type-search-field",staticClass:"flexrow-item mt1",attrs:{placeholder:"ex: chars, agent327"},on:{change:t.onSearchChange}}),s("combobox",{staticClass:"mb0 flexrow-item",attrs:{label:t.$t("statistics.display_mode"),"locale-key-prefix":"statistics.",options:t.displayModeOptions},model:{value:t.displayMode,callback:function(e){t.displayMode=e},expression:"displayMode"}}),s("span",{staticClass:"filler"}),s("button-simple",{staticClass:"flexrow-item",attrs:{icon:"download"},on:{click:t.exportStatisticsToCsv}})],1),s("production-asset-type-list",{ref:"asset-type-list",attrs:{entries:t.displayedAssetTypes,"is-loading":t.isAssetsLoading||t.initialLoading,"is-error":t.isAssetsLoadingError,"validation-columns":t.assetValidationColumns,"asset-type-stats":t.assetTypeStats,"display-mode":t.displayMode,"show-all":0===t.assetTypeSearchText.length},on:{scroll:t.saveScrollPosition}})],1)},i=[],o=(s("a4d3"),s("99af"),s("4de4"),s("4160"),s("a15b"),s("a434"),s("b0c0"),s("e439"),s("dbb4"),s("b64b"),s("159b"),s("ade3")),r=s("c1df"),n=s.n(r),l=s("2f62"),c=s("3455"),d=s("8c97"),p=s("de40"),u=s("992f"),h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"data-list"},[s("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.onBodyScroll,expression:"onBodyScroll"}],ref:"body",staticClass:"datatable-wrapper"},[s("table",{staticClass:"datatable"},[s("thead",{staticClass:"datatable-head"},[s("tr",[s("th",{staticClass:"name datatable-row-header",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("asset_types.fields.name"))+" ")]),s("th",{staticClass:"validation",attrs:{scope:"col"}},[t._v(t._s(t.$t("main.all")))]),t._l(t.validationColumns,(function(e){return t.isLoading?t._e():s("th",{key:e,staticClass:"validation validation-cell",attrs:{scope:"col"}},[s("div",{staticClass:"flexrow validation-content",style:t.getValidationStyle(e)},[t.isCurrentUserClient?s("span",{staticClass:"flexrow-item"},[t._v(" "+t._s(t.taskTypeMap[e].name)+" ")]):s("router-link",{staticClass:"flexrow-item",attrs:{to:t.taskTypePath(e)}},[t._v(" "+t._s(t.taskTypeMap[e].name)+" ")])],1)])})),s("th",{staticClass:"actions",attrs:{scope:"col"}})],2)]),t.isLoading?t._e():s("tbody",{staticClass:"datatable-body"},[t.showAll&&!t.isEmptyList?s("tr",{staticClass:"all-line datatable-row"},[s("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[t._v(" "+t._s(t.$t("asset_types.all_asset_types"))+" ")]),s("stats-cell",{attrs:{colors:t.chartColors("all","all"),data:t.chartData("all","all"),displayMode:t.displayMode}}),t._l(t.validationColumns,(function(e){return s("stats-cell",{key:"all-"+e,style:t.getValidationStyle(e),attrs:{colors:t.chartColors("all",e),data:t.chartData("all",e),displayMode:t.displayMode}})})),s("td",{staticClass:"actions"})],2):t._e(),t._l(t.entries,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row"},[s("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[t._v(" "+t._s(e.name)+" ")]),t.isStats(e.id,"all")?s("stats-cell",{attrs:{colors:t.chartColors(e.id,"all"),data:t.chartData(e.id,"all"),displayMode:t.displayMode}}):s("td"),t._l(t.validationColumns,(function(a){return t.isStats(e.id,a)?s("stats-cell",{key:e.id+a,style:t.getValidationStyle(a),attrs:{colors:t.chartColors(e.id,a),data:t.chartData(e.id,a),displayMode:t.displayMode}}):s("td",{style:t.getValidationStyle(a)})})),s("td",{staticClass:"actions"})],2)}))],2)])]),s("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),!t.isEmptyList||t.isCurrentUserClient||t.isLoading?t._e():s("div",{staticClass:"has-text-centered"},[t._m(0),s("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list")))]),s("button-link",{staticClass:"level-item big-button",attrs:{text:t.$t("assets.new_asset"),path:t.newAssetPath}})],1),t.isEmptyList&&t.isCurrentUserClient&&!t.isLoading?s("div",{staticClass:"has-text-centered"},[t._m(1),s("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list_client")))])]):t._e(),t.isEmptyList||t.isLoading?t._e():s("p",{staticClass:"has-text-centered nb-asset-types"},[t._v(" "+t._s(t.displayedAssetTypesLength)+" "+t._s(t.$tc("asset_types.number",t.displayedAssetTypesLength))+" ")])],1)},y=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"info"},[a("img",{attrs:{src:s("66a5")}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"info"},[a("img",{attrs:{src:s("66a5")}})])}],f=(s("d3b7"),s("ddb0"),s("e9c6")),b=s("09d3"),m=s("e211"),S=s("b131"),T=s("e60b");function v(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function _(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?v(Object(s),!0).forEach((function(e){Object(o["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var C={name:"production-asset-type-list",mixins:[f["a"]],props:{displayMode:{type:String,default:"pie"},entries:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},assetTypeStats:{type:Object,default:function(){}},showAll:{type:Boolean,default:!1},validationColumns:{type:Array,default:function(){return[]}}},data:function(){return{busy:!1,lastSelection:null}},components:{ButtonLink:m["a"],StatsCell:S["a"],TableInfo:T["a"]},computed:_({},Object(l["c"])(["assetTypeSearchText","currentEpisode","currentProduction","displayedAssetTypesLength","isCurrentUserClient","isTVShow","taskTypeMap"]),{isEmptyList:function(){return this.entries&&0===this.entries.length&&!this.isLoading&&!this.isError&&(!this.assetTypeSearchText||0===this.assetTypeSearchText.length)},newAssetPath:function(){var t={name:"new-asset",params:{production_id:this.currentProduction.id}};return this.isTVShow&&this.currentEpisode&&(t.name="episode-new-asset",t.params.episode_id=this.currentEpisode.id),t}}),methods:_({},Object(l["b"])([]),{chartColors:function(t,e){return Object(b["b"])(this.assetTypeStats,t,e)},chartData:function(t,e){return Object(b["c"])(this.assetTypeStats,t,e)},isStats:function(t,e){return this.assetTypeStats[t]&&this.assetTypeStats[t][e]},onHeaderScroll:function(t,e){this.$refs.tableWrapper.scrollLeft=e.scrollLeft},onBodyScroll:function(t,e){this.$emit("scroll",e.scrollTop)},setScrollPosition:function(t){this.$refs.body&&(this.$refs.body.scrollTop=t)},taskTypePath:function(t){var e={name:"task-type",params:{production_id:this.currentProduction.id,task_type_id:t,type:"assets"}};return this.isTVShow&&this.currentEpisode&&(e.name="episode-task-type",e.params.episode_id=this.currentEpisode.id),e},resizeHeaders:function(){}})},g=C,w=(s("835b"),s("2877")),O=Object(w["a"])(g,h,y,!1,null,"f9675122",null),P=O.exports,L=s("4d04");function j(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function x(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?j(Object(s),!0).forEach((function(e){Object(o["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):j(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var k={name:"production-asset-types",components:{ButtonSimple:p["a"],Combobox:u["a"],ProductionAssetTypeList:P,SearchField:L["a"]},data:function(){return{initialLoading:!0,displayMode:"pie",displayModeOptions:[{label:"pie",value:"pie"},{label:"count",value:"count"}]}},computed:x({},Object(l["c"])(["assetTypeMap","assetTypePath","assetTypeStats","assetTypeSearchText","assetTypeListScrollPosition","assetValidationColumns","currentEpisode","currentProduction","displayedAssetTypes","isAssetsLoading","isAssetsLoadingError","isTVShow","taskStatusMap","taskTypeMap"])),created:function(){},mounted:function(){var t=this;this.setDefaultSearchText(),this.setDefaultListScrollPosition(),setTimeout((function(){t.reset()}),100)},methods:x({},Object(l["b"])(["computeAssetTypeStats","initAssetTypes","loadAssets","loadComment","setAssetTypeSearch","setAssetTypeListScrollPosition","setLastProductionScreen"]),{setDefaultSearchText:function(){this.assetTypeSearchText.length>0&&this.$refs["asset-type-search-field"].setValue(this.assetTypeSearchText)},setDefaultListScrollPosition:function(){this.$refs["asset-type-list"].setScrollPosition(this.assetTypeListScrollPosition)},navigateToList:function(){this.$router.push(this.assetTypesPath)},onSearchChange:function(t){var e=this.$refs["asset-type-search-field"].getValue();this.setAssetTypeSearch(e)},saveScrollPosition:function(t){this.setAssetTypeListScrollPosition(t)},exportStatisticsToCsv:function(){var t=[n()().format("YYYYMMDD"),this.currentProduction.name,"asset_types","statistics"];this.currentEpisode&&t.splice(2,0,this.currentEpisode.name);var e=Object(d["b"])(t.join("_"));c["a"].generateStatReports(e,this.assetTypeStats,this.taskTypeMap,this.taskStatusMap,this.assetTypeMap,this.countMode)},reset:function(){var t=this;this.initialLoading=!0,this.$refs["asset-type-search-field"].setValue(""),this.loadAssets().then(this.handleModalsDisplay).then((function(){t.computeAssetTypeStats(),t.setAssetTypeListScrollPosition(0),t.initialLoading=!1}))}}),watch:{currentProduction:function(){this.isTVShow||this.reset()},currentEpisode:function(){this.isTVShow&&this.reset()}},socket:{events:{"comment:new":function(t){var e=this,s=t.comment_id;this.loadComment({commentId:s,callback:function(){e.computeAssetTypeStats()}})}}},metaInfo:function(){return{title:"".concat(this.currentProduction.name," | ").concat(this.$t("asset_types.production_title")," - Kitsu")}}},M=k,A=Object(w["a"])(M,a,i,!1,null,"4f578ff6",null);e["default"]=A.exports}}]);
//# sourceMappingURL=chunk-280f9bc6.e09000fb.js.map