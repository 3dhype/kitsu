{"version":3,"sources":["webpack:///./src/components/widgets/PreviewRow.vue?5640","webpack:///./src/components/pages/Task.vue?224c","webpack:///./src/components/widgets/ButtonLink.vue?260f","webpack:///./src/components/pages/Task.vue?0bab","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./src/components/widgets/PreviewRow.vue?01e2","webpack:///src/components/widgets/PreviewRow.vue","webpack:///./src/components/widgets/PreviewRow.vue?2db5","webpack:///./src/components/widgets/PreviewRow.vue","webpack:///src/components/pages/Task.vue","webpack:///./src/components/pages/Task.vue?f467","webpack:///./src/components/pages/Task.vue","webpack:///./src/components/widgets/ButtonLink.vue?ad88","webpack:///src/components/widgets/ButtonLink.vue","webpack:///./src/components/widgets/ButtonLink.vue?b68b","webpack:///./src/components/widgets/ButtonLink.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","attrs","entityPage","taskEntityPath","_v","_s","currentTask","title","currentTaskType","currentProduction","id","_e","isAssigned","isSubscribed","on","toggleSubscribe","$t","_l","personId","key","personMap","ref","loading","addComment","errors","user","currentTeam","taskStatusForCurrentUser","attachedFileName","onAddPreviewClicked","onDuplicateComment","selectFile","currentTaskComments","length","comment","index","isHighlighted","person","pinnedCount","ackComment","onPinComment","onEditComment","onDeleteComment","saveComment","currentTaskPreviews","isCurrentUserManager","class","button","setPreview","entity","preview_file_id","currentPreviewId","preview","previewPath","isMovie","currentPreview","taskTypeMap","taskEntityPreviews","isCurrentUserArtist","onAnnotationChanged","currentPreviewDlPath","extension","currentPreviewPath","includes","onAddExtraPreview","showRemoveExtraPreviewModal","modals","addPreview","addPreviewFormData","$event","closeAddPreviewModal","addExtraPreview","addExtraPreviewFormData","hideExtraPreviewModal","createExtraPreview","editComment","commentToEdit","confirmEditTaskComment","onCancelEditComment","deleteComment","confirmDeleteTaskComment","onCancelDeleteComment","deleteExtraPreview","hideRemoveExtraPreviewModal","confirmDeleteTaskPreview","staticRenderFns","_typeof","obj","Symbol","iterator","constructor","prototype","selected","label","name","components","ButtonLink","props","type","Object","default","Boolean","computed","methods","component","AddComment","AddPreviewModal","Comment","ChevronLeftIcon","DeleteModal","DownloadIcon","EditCommentModal","ImageIcon","ModelViewer","PeopleAvatar","PreviewRow","PictureViewer","Spinner","SubscribeButton","TaskTypeName","ValidationTag","VideoPlayer","data","currentExtraPreviewId","getEntityPage","selectedTab","taskLoading","isLoading","isError","deleteTask","otherPreviews","created","clearSelectedTasks","loadTaskData","mounted","handleModalsDisplay","reset","$nextTick","window","scrollTo","isCommentingAllowed","assignees","find","taskTypeBorder","border","task_type_color","deleteTaskPath","taskPath","isPreviews","entityId","entity_id","params","production_id","project_id","route","shot_id","asset_id","$route","episode_id","entityList","displayedShots","displayedAssets","previousEntity","nextEntity","isTVShow","entityName","windowTitle","deleteText","previewId","moviePath","some","assigneeId","isPreviewButtonVisible","isDlPreviewFile","task_type_id","team","map","filter","task","loadTaskComments","taskId","task_id","callback","err","console","error","loadTask","entity_type_name","loadingFunction","getCurrentTask","taskMap","getCurrentComment","comment_id","getTaskComment","getCurrentTaskComments","getTaskComments","getCurrentTaskPreviews","getTaskPreviews","getCurrentTaskPath","getOriginalPath","getOriginalDlPath","getPreviewPath","taskStatusId","checklist","attachment","action","$store","dispatch","setOtherPreviews","loadPreviewFileFormData","forms","createPreview","addCommentPreview","commentId","previews","findIndex","addCommentExtraPreview","resetPreview","$router","push","confirmDeleteTask","editTaskComment","deleteTaskComment","$refs","displayFirst","deleteTaskPreview","onPreviewAdded","commit","revision","unsubscribeFromTask","subscribeToTask","section","currentEpisode","preview_id","updatePreviewAnnotation","setValue","pinComment","onRemoteAcknowledge","watch","socket","events","eventData","refreshPreview","metaInfo","path","icon","startsWith","isText","text","isResponsive","EditIcon","PlusIcon","RotateCcwIcon","TrashIcon","UploadIcon","String"],"mappings":"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","file":"js/chunk-401f3000.b9a6cfff.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewRow.vue?vue&type=style&index=0&id=62a8ce6e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewRow.vue?vue&type=style&index=0&id=62a8ce6e&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Task.vue?vue&type=style&index=0&id=7fbc429d&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Task.vue?vue&type=style&index=0&id=7fbc429d&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ButtonLink.vue?vue&type=style&index=0&id=143e1424&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ButtonLink.vue?vue&type=style&index=0&id=143e1424&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page fixed-page\"},[_c('div',{staticStyle:{\"overflow-y\":\"auto\"}},[_c('div',{staticClass:\"page-header\"},[(_vm.currentTask)?_c('div',{staticClass:\"flexrow header-title\"},[_c('router-link',{staticClass:\"flexrow-item has-text-centered back-link\",attrs:{\"to\":_vm.entityPage}},[_c('chevron-left-icon')],1),_c('div',{staticClass:\"title flexrow-item\"},[_c('router-link',{attrs:{\"to\":_vm.taskEntityPath}},[_vm._v(\" \"+_vm._s(_vm.currentTask ? _vm.title : 'Loading...')+\" \")])],1),(_vm.currentTaskType)?_c('task-type-name',{staticClass:\"flexrow-item task-type\",attrs:{\"task-type\":_vm.currentTaskType,\"production-id\":_vm.currentProduction.id}}):_vm._e(),(!_vm.isAssigned)?_c('subscribe-button',{staticClass:\"flexrow-item action-button\",attrs:{\"subscribed\":_vm.isAssigned || _vm.isSubscribed},on:{\"click\":_vm.toggleSubscribe}}):_vm._e()],1):_vm._e(),(_vm.currentTask)?_c('div',{staticClass:\"flexrow task-information\"},[_c('span',{staticClass:\"flexrow-item\"},[_vm._v(_vm._s(_vm.$t('tasks.current_status')))]),(_vm.currentTask)?_c('validation-tag',{staticClass:\"is-medium flexrow-item\",attrs:{\"task\":_vm.currentTask,\"is-static\":true}}):_vm._e(),_c('span',{staticClass:\"flexrow-item\"},[_vm._v(_vm._s(_vm.$t('tasks.fields.assignees'))+\":\")]),_vm._l((_vm.currentTask.assignees),function(personId){return _c('span',{key:personId,staticClass:\"flexrow-item avatar-wrapper\"},[_c('people-avatar',{key:personId,staticClass:\"flexrow-item\",attrs:{\"person\":_vm.personMap[personId],\"size\":30,\"font-size\":16}})],1)})],2):_vm._e()]),_c('div',{ref:\"task-columns\",staticClass:\"task-columns\"},[_c('div',{staticClass:\"task-column comments-column\"},[(_vm.currentTask)?_c('div',[_c('div',[(_vm.isCommentingAllowed)?_c('add-comment',{ref:\"add-comment\",attrs:{\"is-loading\":_vm.loading.addComment,\"is-error\":_vm.errors.addComment,\"user\":_vm.user,\"team\":_vm.currentTeam,\"task\":_vm.currentTask,\"task-status\":_vm.taskStatusForCurrentUser,\"attached-file-name\":_vm.attachedFileName},on:{\"add-comment\":_vm.addComment,\"add-preview\":_vm.onAddPreviewClicked,\"duplicate-comment\":_vm.onDuplicateComment,\"file-drop\":_vm.selectFile}}):_vm._e(),(_vm.currentTaskComments && _vm.currentTaskComments.length > 0)?_c('div',{staticClass:\"comments\"},_vm._l((_vm.currentTaskComments),function(comment,index){return _c('comment',{key:comment.id,attrs:{\"comment\":comment,\"task\":_vm.currentTask,\"highlighted\":_vm.isHighlighted(comment),\"current-user\":_vm.user,\"editable\":comment.person && _vm.user.id === comment.person.id,\"is-first\":index === 0,\"is-last\":index === _vm.pinnedCount},on:{\"ack-comment\":_vm.ackComment,\"pin-comment\":_vm.onPinComment,\"edit-comment\":_vm.onEditComment,\"delete-comment\":_vm.onDeleteComment,\"checklist-updated\":_vm.saveComment}})}),1):_c('div',{staticClass:\"no-comment\"},[_c('em',[_vm._v(\" \"+_vm._s(_vm.$t('tasks.no_comment'))+\" \")])])],1)]):_c('div',{staticClass:\"has-text-centered\"},[_c('spinner')],1)]),_c('div',{staticClass:\"task-column preview-column\"},[_c('div',{staticClass:\"preview-column-content\"},[_c('div',{staticClass:\"flexrow preview-header\"},[_c('h2',{staticClass:\"subtitle flexrow-item\"},[_vm._v(\" \"+_vm._s(_vm.$t('tasks.preview'))+\" \")]),(_vm.isPreviewButtonVisible)?_c('div',{staticClass:\"set-main-preview flexrow-item flexrow pull-right\"},[(_vm.currentTaskPreviews && _vm.currentTaskPreviews.length > 0 && _vm.isCurrentUserManager)?_c('button',{class:{\n                button: true,\n                'flexrow-item': true,\n                'is-loading': _vm.loading.setPreview\n              },on:{\"click\":_vm.setPreview}},[_c('image-icon',{staticClass:\"icon\"}),_c('span',{staticClass:\"text\"},[_vm._v(\" \"+_vm._s(_vm.$t('tasks.set_preview'))+\" \")])],1):_vm._e(),(_vm.errors.setPreview)?_c('span',{staticClass:\"error flexrow-item\"},[_vm._v(\" \"+_vm._s(_vm.$t('tasks.set_preview_error'))+\" \")]):_vm._e()]):_vm._e(),(_vm.currentTask && _vm.currentTask.entity && _vm.currentTask.entity.preview_file_id === _vm.currentPreviewId)?_c('div',{staticClass:\"set-main-preview flexrow-item pull-right\"},[_c('em',[_vm._v(_vm._s(_vm.$t('tasks.set_preview_done')))])]):_vm._e()]),(_vm.isPreviews)?_c('div',{staticClass:\"preview-list mt2\"},_vm._l((_vm.currentTaskPreviews),function(preview){return _c('preview-row',{key:preview.id,attrs:{\"preview\":preview,\"preview-path\":_vm.previewPath(preview.id),\"taskId\":_vm.currentTask ? _vm.currentTask.id : '',\"selected\":preview.id === _vm.currentPreviewId}})}),1):_c('div',[_c('em',[_vm._v(\" \"+_vm._s(_vm.$t('tasks.no_preview'))+\" \")])]),_c('div',{staticClass:\"preview-picture\"},[(_vm.currentTaskPreviews && _vm.currentTaskPreviews.length > 0 && _vm.isMovie)?_c('div',[_c('video-player',{ref:\"preview-movie\",attrs:{\"preview\":_vm.currentPreview,\"task-type-map\":_vm.taskTypeMap,\"entity-preview-files\":_vm.taskEntityPreviews,\"read-only\":_vm.isCurrentUserArtist},on:{\"annotationchanged\":_vm.onAnnotationChanged}})],1):(_vm.isDlPreviewFile)?_c('a',{ref:\"preview-file\",staticClass:\"button mt2\",attrs:{\"href\":_vm.currentPreviewDlPath}},[_c('download-icon',{staticClass:\"icon\"}),_c('span',{staticClass:\"text\"},[_vm._v(\" \"+_vm._s(_vm.$t('tasks.download_pdf_file', {extension: _vm.extension}))+\" \")])],1):(_vm.currentTaskPreviews && _vm.currentTaskPreviews.length > 0 && _vm.extension === 'obj')?_c('model-viewer',{attrs:{\"preview-url\":_vm.currentPreviewPath,\"preview-dl-path\":_vm.currentPreviewDlPath}}):(_vm.currentTaskPreviews && _vm.currentTaskPreviews.length > 0 && ['png', 'gif'].includes(this.extension))?_c('picture-viewer',{ref:\"preview-picture\",attrs:{\"preview\":_vm.currentPreview,\"read-only\":_vm.isCurrentUserArtist},on:{\"annotation-changed\":_vm.onAnnotationChanged,\"add-preview\":_vm.onAddExtraPreview,\"remove-extra-preview\":_vm.showRemoveExtraPreviewModal}}):_vm._e()],1)])])]),_c('add-preview-modal',{ref:\"add-preview-modal\",attrs:{\"active\":_vm.modals.addPreview,\"is-loading\":_vm.loading.addPreview,\"is-error\":_vm.errors.addPreview,\"form-data\":_vm.addPreviewFormData},on:{\"cancel\":function($event){_vm.modals.addPreview = false},\"fileselected\":_vm.selectFile,\"confirm\":_vm.closeAddPreviewModal}}),_c('add-preview-modal',{ref:\"add-extra-preview-modal\",attrs:{\"active\":_vm.modals.addExtraPreview,\"is-loading\":_vm.loading.addExtraPreview,\"is-error\":_vm.errors.addExtraPreview,\"form-data\":_vm.addExtraPreviewFormData,\"extensions\":\".png,.jpg,.jpeg\"},on:{\"cancel\":_vm.hideExtraPreviewModal,\"fileselected\":_vm.selectFile,\"confirm\":_vm.createExtraPreview}}),_c('edit-comment-modal',{attrs:{\"active\":_vm.modals.editComment,\"is-loading\":_vm.loading.editComment,\"is-error\":_vm.errors.editComment,\"comment-to-edit\":_vm.commentToEdit,\"team\":_vm.currentTeam},on:{\"confirm\":_vm.confirmEditTaskComment,\"cancel\":_vm.onCancelEditComment}}),_c('delete-modal',{attrs:{\"active\":_vm.modals.deleteComment,\"is-loading\":_vm.loading.deleteComment,\"is-error\":_vm.errors.deleteComment,\"text\":_vm.$t('tasks.delete_comment'),\"error-text\":_vm.$t('tasks.delete_comment_error')},on:{\"confirm\":_vm.confirmDeleteTaskComment,\"cancel\":_vm.onCancelDeleteComment}}),_c('delete-modal',{attrs:{\"active\":_vm.modals.deleteExtraPreview,\"is-loading\":_vm.loading.deleteExtraPreview,\"is-error\":_vm.errors.deleteExtraPreview,\"text\":_vm.$t('tasks.delete_preview'),\"error-text\":_vm.$t('tasks.delete_preview_error')},on:{\"cancel\":_vm.hideRemoveExtraPreviewModal,\"confirm\":_vm.confirmDeleteTaskPreview}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default function _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{\n  'preview-row': true,\n  'has-text-center': true,\n  selected: _vm.selected\n}},[_c('button-link',{attrs:{\"text\":_vm.label,\"path\":_vm.previewPath}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div :class=\"{\n  'preview-row': true,\n  'has-text-center': true,\n  selected: selected\n}\">\n  <button-link\n    :text=\"label\"\n    :path=\"previewPath\"\n  >\n  </button-link>\n</div>\n</template>\n\n<script>\nimport ButtonLink from './ButtonLink.vue'\n\nexport default {\n  name: 'preview-row',\n  components: {\n    ButtonLink\n  },\n  props: {\n    preview: {\n      type: Object,\n      default: () => {}\n    },\n    selected: {\n      type: Boolean,\n      default: false\n    },\n    previewPath: {\n      type: Object,\n      default: () => {}\n    }\n  },\n  computed: {\n    label () {\n      const label = `v${this.preview.revision}`\n      return label\n    }\n  },\n  methods: {\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.preview-row {\n  margin-right: 0.5em;\n}\n\n.preview-row a {\n  border: 3px solid $light-grey;\n}\n\n.preview-row:hover a {\n  border: 3px solid #E1D4F9;\n}\n\n.preview-row.selected a {\n  border: 3px solid #8F91EB;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewRow.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewRow.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PreviewRow.vue?vue&type=template&id=62a8ce6e&scoped=true&\"\nimport script from \"./PreviewRow.vue?vue&type=script&lang=js&\"\nexport * from \"./PreviewRow.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PreviewRow.vue?vue&type=style&index=0&id=62a8ce6e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"62a8ce6e\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"page fixed-page\">\n  <div style=\"overflow-y: auto;\">\n    <div class=\"page-header\">\n      <div\n        class=\"flexrow header-title\"\n        v-if=\"currentTask\"\n      >\n        <router-link\n          :to=\"entityPage\"\n          class=\"flexrow-item has-text-centered back-link\"\n        >\n          <chevron-left-icon />\n        </router-link>\n        <div class=\"title flexrow-item\">\n          <router-link :to=\"taskEntityPath\">\n            {{ currentTask ? title : 'Loading...'}}\n          </router-link>\n        </div>\n        <task-type-name\n          class=\"flexrow-item task-type\"\n          :task-type=\"currentTaskType\"\n          :production-id=\"currentProduction.id\"\n          v-if=\"currentTaskType\"\n        />\n        <subscribe-button\n          class=\"flexrow-item action-button\"\n          :subscribed=\"isAssigned || isSubscribed\"\n          @click=\"toggleSubscribe\"\n          v-if=\"!isAssigned\"\n        />\n      </div>\n\n      <div\n        class=\"flexrow task-information\"\n        v-if=\"currentTask\"\n      >\n        <span class=\"flexrow-item\">{{ $t('tasks.current_status') }}</span>\n        <validation-tag\n          class=\"is-medium flexrow-item\"\n          :task=\"currentTask\"\n          :is-static=\"true\"\n          v-if=\"currentTask\"\n        />\n        <span class=\"flexrow-item\">{{ $t('tasks.fields.assignees') }}:</span>\n        <span\n          class=\"flexrow-item avatar-wrapper\"\n          :key=\"personId\"\n          v-for=\"personId in currentTask.assignees\"\n        >\n          <people-avatar\n            class=\"flexrow-item\"\n            :key=\"personId\"\n            :person=\"personMap[personId]\"\n            :size=\"30\"\n            :font-size=\"16\"\n          />\n       </span>\n      </div>\n    </div>\n\n    <div class=\"task-columns\" ref=\"task-columns\">\n      <div class=\"task-column comments-column\">\n        <div v-if=\"currentTask\">\n          <div>\n            <add-comment\n              ref=\"add-comment\"\n              :is-loading=\"loading.addComment\"\n              :is-error=\"errors.addComment\"\n              :user=\"user\"\n              :team=\"currentTeam\"\n              :task=\"currentTask\"\n              :task-status=\"taskStatusForCurrentUser\"\n              :attached-file-name=\"attachedFileName\"\n              @add-comment=\"addComment\"\n              @add-preview=\"onAddPreviewClicked\"\n              @duplicate-comment=\"onDuplicateComment\"\n              @file-drop=\"selectFile\"\n              v-if=\"isCommentingAllowed\"\n            />\n            <div class=\"comments\" v-if=\"currentTaskComments && currentTaskComments.length > 0\">\n              <comment\n                :comment=\"comment\"\n                :task=\"currentTask\"\n                :highlighted=\"isHighlighted(comment)\"\n                :key=\"comment.id\"\n                :current-user=\"user\"\n                :editable=\"comment.person && user.id === comment.person.id\"\n                :is-first=\"index === 0\"\n                :is-last=\"index === pinnedCount\"\n                @ack-comment=\"ackComment\"\n                @pin-comment=\"onPinComment\"\n                @edit-comment=\"onEditComment\"\n                @delete-comment=\"onDeleteComment\"\n                @checklist-updated=\"saveComment\"\n                v-for=\"(comment, index) in currentTaskComments\"\n              />\n            </div>\n            <div class=\"no-comment\" v-else>\n              <em>\n                {{ $t('tasks.no_comment')}}\n              </em>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"has-text-centered\" v-else>\n          <spinner />\n        </div>\n      </div>\n\n      <div class=\"task-column preview-column\">\n        <div class=\"preview-column-content\">\n          <div class=\"flexrow preview-header\">\n            <h2 class=\"subtitle flexrow-item\">\n              {{ $t('tasks.preview') }}\n            </h2>\n            <div\n              class=\"set-main-preview flexrow-item flexrow pull-right\"\n              v-if=\"isPreviewButtonVisible\"\n            >\n              <button\n                :class=\"{\n                  button: true,\n                  'flexrow-item': true,\n                  'is-loading': loading.setPreview\n                }\"\n                @click=\"setPreview\"\n                v-if=\"currentTaskPreviews && currentTaskPreviews.length > 0 && isCurrentUserManager\"\n              >\n                <image-icon class=\"icon\" />\n                <span class=\"text\">\n                  {{ $t('tasks.set_preview') }}\n                </span>\n              </button>\n              <span class=\"error flexrow-item\" v-if=\"errors.setPreview\">\n                {{ $t('tasks.set_preview_error') }}\n              </span>\n            </div>\n            <div\n              class=\"set-main-preview flexrow-item pull-right\"\n              v-if=\"currentTask && currentTask.entity && currentTask.entity.preview_file_id === currentPreviewId\">\n              <em>{{ $t('tasks.set_preview_done') }}</em>\n            </div>\n          </div>\n\n          <div\n            class=\"preview-list mt2\"\n            v-if=\"isPreviews\"\n          >\n            <preview-row\n              :key=\"preview.id\"\n              :preview=\"preview\"\n              :preview-path=\"previewPath(preview.id)\"\n              :taskId=\"currentTask ? currentTask.id : ''\"\n              :selected=\"preview.id === currentPreviewId\"\n              v-for=\"preview in currentTaskPreviews\"\n            />\n          </div>\n          <div v-else>\n            <em>\n              {{ $t('tasks.no_preview')}}\n            </em>\n          </div>\n\n          <div class=\"preview-picture\">\n            <div\n              v-if=\"currentTaskPreviews && currentTaskPreviews.length > 0 && isMovie\"\n            >\n              <video-player\n                :preview=\"currentPreview\"\n                :task-type-map=\"taskTypeMap\"\n                :entity-preview-files=\"taskEntityPreviews\"\n                :read-only=\"isCurrentUserArtist\"\n                @annotationchanged=\"onAnnotationChanged\"\n                ref=\"preview-movie\"\n              />\n            </div>\n\n            <a\n              class=\"button mt2\"\n              ref=\"preview-file\"\n              :href=\"currentPreviewDlPath\"\n              v-else-if=\"isDlPreviewFile\"\n            >\n              <download-icon class=\"icon\" />\n              <span class=\"text\">\n                {{ $t('tasks.download_pdf_file', {extension}) }}\n              </span>\n            </a>\n\n            <model-viewer\n              :preview-url=\"currentPreviewPath\"\n              :preview-dl-path=\"currentPreviewDlPath\"\n              v-else-if=\"currentTaskPreviews && currentTaskPreviews.length > 0 && extension === 'obj'\"\n            />\n\n            <picture-viewer\n              :preview=\"currentPreview\"\n              :read-only=\"isCurrentUserArtist\"\n              @annotation-changed=\"onAnnotationChanged\"\n              @add-preview=\"onAddExtraPreview\"\n              @remove-extra-preview=\"showRemoveExtraPreviewModal\"\n              ref=\"preview-picture\"\n              v-else-if=\"currentTaskPreviews && currentTaskPreviews.length > 0 && ['png', 'gif'].includes(this.extension)\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <add-preview-modal\n      ref=\"add-preview-modal\"\n      :active=\"modals.addPreview\"\n      :is-loading=\"loading.addPreview\"\n      :is-error=\"errors.addPreview\"\n      :form-data=\"addPreviewFormData\"\n      @cancel=\"modals.addPreview = false\"\n      @fileselected=\"selectFile\"\n      @confirm=\"closeAddPreviewModal\"\n    />\n\n    <add-preview-modal\n      ref=\"add-extra-preview-modal\"\n      :active=\"modals.addExtraPreview\"\n      :is-loading=\"loading.addExtraPreview\"\n      :is-error=\"errors.addExtraPreview\"\n      :form-data=\"addExtraPreviewFormData\"\n      extensions=\".png,.jpg,.jpeg\"\n      @cancel=\"hideExtraPreviewModal\"\n      @fileselected=\"selectFile\"\n      @confirm=\"createExtraPreview\"\n    />\n\n    <edit-comment-modal\n      :active=\"modals.editComment\"\n      :is-loading=\"loading.editComment\"\n      :is-error=\"errors.editComment\"\n      :comment-to-edit=\"commentToEdit\"\n      :team=\"currentTeam\"\n      @confirm=\"confirmEditTaskComment\"\n      @cancel=\"onCancelEditComment\"\n    />\n\n    <delete-modal\n      :active=\"modals.deleteComment\"\n      :is-loading=\"loading.deleteComment\"\n      :is-error=\"errors.deleteComment\"\n      :text=\"$t('tasks.delete_comment')\"\n      :error-text=\"$t('tasks.delete_comment_error')\"\n      @confirm=\"confirmDeleteTaskComment\"\n      @cancel=\"onCancelDeleteComment\"\n    />\n\n    <delete-modal\n      :active=\"modals.deleteExtraPreview\"\n      :is-loading=\"loading.deleteExtraPreview\"\n      :is-error=\"errors.deleteExtraPreview\"\n      :text=\"$t('tasks.delete_preview')\"\n      :error-text=\"$t('tasks.delete_preview_error')\"\n      @cancel=\"hideRemoveExtraPreviewModal\"\n      @confirm=\"confirmDeleteTaskPreview\"\n    />\n  </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport {\n  ChevronLeftIcon,\n  DownloadIcon,\n  ImageIcon\n} from 'vue-feather-icons'\n\nimport AddComment from '../widgets/AddComment'\nimport AddPreviewModal from '../modals/AddPreviewModal'\nimport Comment from '../widgets/Comment'\nimport DeleteModal from '../modals/DeleteModal'\nimport EditCommentModal from '../modals/EditCommentModal'\nimport ModelViewer from '../previews/ModelViewer'\nimport PeopleAvatar from '../widgets/PeopleAvatar'\nimport PictureViewer from '../previews/PictureViewer'\nimport PreviewRow from '../widgets/PreviewRow'\nimport Spinner from '../widgets/Spinner'\nimport SubscribeButton from '../widgets/SubscribeButton'\nimport TaskTypeName from '../widgets/TaskTypeName'\nimport ValidationTag from '../widgets/ValidationTag'\nimport VideoPlayer from '../previews/VideoPlayer'\n\nexport default {\n  name: 'task',\n  components: {\n    AddComment,\n    AddPreviewModal,\n    Comment,\n    ChevronLeftIcon,\n    DeleteModal,\n    DownloadIcon,\n    EditCommentModal,\n    ImageIcon,\n    ModelViewer,\n    PeopleAvatar,\n    PreviewRow,\n    PictureViewer,\n    Spinner,\n    SubscribeButton,\n    TaskTypeName,\n    ValidationTag,\n    VideoPlayer\n  },\n\n  data () {\n    return {\n      attachedFileName: '',\n      currentPreviewId: null,\n      currentExtraPreviewId: null,\n      entityPage: this.getEntityPage(),\n      selectedTab: 'validation',\n      taskLoading: {\n        isLoading: true,\n        isError: false\n      },\n      modals: {\n        addPreview: false,\n        addExtraPreview: false,\n        deleteExtraPreview: false,\n        deleteTask: false,\n        deleteComment: false,\n        editComment: false\n      },\n      loading: {\n        addComment: false,\n        addPreview: false,\n        addExtraPreview: false,\n        setPreview: false,\n        deleteTask: false,\n        deleteComment: false,\n        editComment: false\n      },\n      errors: {\n        addComment: false,\n        addPreview: false,\n        addExtraPreview: false,\n        setPreview: false,\n        deleteTask: false,\n        deleteComment: false,\n        editComment: false\n      },\n      currentTask: null,\n      currentTaskComments: [],\n      currentTaskPreviews: [],\n      commentToEdit: null,\n      otherPreviews: [],\n      addPreviewFormData: null,\n      addExtraPreviewFormData: null,\n      isSubscribed: false,\n      currentPreviewPath: '',\n      currentPreviewDlPath: ''\n    }\n  },\n\n  created () {\n    this.clearSelectedTasks()\n    this.loadTaskData()\n  },\n\n  mounted () {\n    this.handleModalsDisplay()\n    this.reset()\n    this.$nextTick(() => {\n      if (this.$refs['task-columns']) {\n        this.$refs['task-columns'].scrollTop = 100\n        window.scrollTo(0, 0)\n      }\n    })\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentEpisode',\n      'currentProduction',\n      'displayedShots',\n      'displayedAssets',\n      'getTaskComments',\n      'getTaskPreviews',\n      'getTaskComment',\n      'isCurrentUserManager',\n      'isCurrentUserArtist',\n      'isSingleEpisode',\n      'isTVShow',\n      'personMap',\n      'productionMap',\n      'route',\n      'taskEntityPreviews',\n      'taskStatus',\n      'taskStatusForCurrentUser',\n      'taskMap',\n      'taskTypeMap',\n      'user'\n    ]),\n\n    isCommentingAllowed () {\n      return this.isCurrentUserManager || this.currentTask.assignees.find(\n        (personId) => personId === this.user.id\n      )\n    },\n\n    taskTypeBorder () {\n      let border = 'transparent'\n      if (this.currentTask) border = this.currentTask.task_type_color\n      return {\n        'border-left': `4px solid ${border}`\n      }\n    },\n\n    deleteTaskPath () {\n      return this.taskPath(this.currentTask, 'task-delete')\n    },\n\n    isPreviews () {\n      return this.currentTaskPreviews && this.currentTaskPreviews.length > 0\n    },\n\n    taskEntityPath () {\n      if (this.currentTask) {\n        const type = this.currentTask.entity_type_name\n        let entityId = ''\n        if (this.currentTask.entity) {\n          entityId = this.currentTask.entity.id\n        } else {\n          entityId = this.currentTask.entity_id\n        }\n\n        const route = {\n          name: type === 'Shot' ? 'shot' : 'asset',\n          params: {\n            production_id: this.currentTask.project_id\n          }\n        }\n\n        if (type === 'Shot') {\n          route.params.shot_id = entityId\n        } else {\n          route.params.asset_id = entityId\n        }\n\n        if (this.$route.params.episode_id) {\n          route.name = `episode-${route.name}`\n          route.params.episode_id = this.$route.params.episode_id\n        }\n\n        return route\n      } else {\n        return {\n          name: 'open-productions'\n        }\n      }\n    },\n\n    entityList () {\n      const entity = this.displayedShots.find((entity) => {\n        return entity.id === this.currentTask.entity_id\n      })\n      if (entity) {\n        return this.displayedShots\n      } else {\n        return this.displayedAssets\n      }\n    },\n\n    previousEntity () {\n      if (this.currentTask) {\n        const taskTypeId = this.currentTask.task_type_id\n        const entityIndex = this.entityList.findIndex((entity) => {\n          return entity.id === this.currentTask.entity_id\n        })\n        let firstTraversal = false\n\n        let previousEntityIndex = entityIndex - 1\n        if (previousEntityIndex < 0) {\n          previousEntityIndex = this.entityList.length - 1\n        }\n\n        let taskId = null\n        while (!taskId) {\n          if (this.entityList[previousEntityIndex]) {\n            const entity = this.entityList[previousEntityIndex]\n            taskId = entity.tasks.find((ctaskId) => {\n              const task = this.taskMap[ctaskId]\n              if (task) {\n                return task.task_type_id === taskTypeId\n              } else {\n                return false\n              }\n            })\n          } else {\n            taskId = this.currentTask.id\n          }\n\n          if (!taskId) {\n            previousEntityIndex--\n            if (previousEntityIndex < 0) {\n              previousEntityIndex = this.entityList.length\n              if (firstTraversal) {\n                return null\n              }\n              firstTraversal = true\n            }\n          }\n        }\n\n        return this.taskPath({ id: taskId })\n      } else {\n        return {\n          name: 'open-productions'\n        }\n      }\n    },\n\n    nextEntity () {\n      if (this.currentTask) {\n        const taskTypeId = this.currentTask.task_type_id\n        let firstTraversal = false\n        const entityIndex = this.entityList.findIndex((entity) => {\n          return entity.id === this.currentTask.entity_id\n        })\n\n        let nextEntityIndex = entityIndex + 1\n        if (nextEntityIndex >= this.entityList.length) {\n          nextEntityIndex = 0\n        }\n\n        let taskId = null\n        while (!taskId) {\n          if (this.entityList[nextEntityIndex]) {\n            const entity = this.entityList[nextEntityIndex]\n            taskId = entity.tasks.find((ctaskId) => {\n              const task = this.taskMap[ctaskId]\n              if (task) {\n                return task.task_type_id === taskTypeId\n              } else {\n                return false\n              }\n            })\n          } else {\n            taskId = this.currentTask.id\n          }\n\n          if (!taskId) {\n            nextEntityIndex++\n            if (nextEntityIndex >= this.entityList.length) {\n              nextEntityIndex = 0\n\n              if (firstTraversal) {\n                return null\n              }\n              firstTraversal = true\n            }\n          }\n        }\n\n        return this.taskPath({ id: taskId })\n      } else {\n        return {\n          name: 'open-productions'\n        }\n      }\n    },\n\n    title () {\n      if (this.currentTask) {\n        const type = this.currentTask.entity_type_name\n        let entityName =\n          this.currentTask.full_entity_name || this.currentTask.entity_name\n        if (this.isTVShow && type === 'Shot') {\n          entityName = entityName\n            .split('/')\n            .splice(1)\n            .join('/')\n        }\n        return `${entityName}`\n      } else {\n        return 'Loading...'\n      }\n    },\n\n    windowTitle () {\n      if (this.currentTask) {\n        const taskTypeName = this.currentTask.task_type_name\n        return `${this.title} / ${taskTypeName}`\n      } else {\n        return 'Loading...'\n      }\n    },\n\n    deleteText () {\n      if (this.currentTask) {\n        const taskType = this.taskTypeMap[this.currentTask.task_type_id]\n        return this.$t('main.delete_text', {\n          name: `${this.currentTask.entity_name} / ${taskType.name}`\n        })\n      } else {\n        return ''\n      }\n    },\n\n    isMovie () {\n      if (this.currentTaskPreviews) {\n        const previewId = this.route.params.preview_id\n        let currentPreview = this.currentTaskPreviews[0]\n        if (previewId) {\n          currentPreview = this.currentTaskPreviews.find((preview) => {\n            return preview.id === previewId\n          })\n        }\n        return currentPreview && currentPreview.extension === 'mp4'\n      } else {\n        return false\n      }\n    },\n\n    extension () {\n      if (this.currentTaskPreviews) {\n        const previewId = this.route.params.preview_id\n        let currentPreview = this.currentTaskPreviews[0]\n        if (previewId) {\n          currentPreview = this.currentTaskPreviews.find((preview) => {\n            return preview.id === previewId\n          })\n        }\n        return currentPreview ? currentPreview.extension : ''\n      } else {\n        return ''\n      }\n    },\n\n    moviePath () {\n      let previewId = this.route.params.preview_id\n      if (!previewId && this.currentTaskPreviews) {\n        previewId = this.currentTaskPreviews[0].id\n      }\n      return `/api/movies/originals/preview-files/${previewId}.mp4`\n    },\n\n    isAssigned () {\n      if (this.currentTask) {\n        return this.currentTask.assignees.some((assigneeId) => {\n          return assigneeId === this.user.id\n        })\n      } else {\n        return false\n      }\n    },\n\n    isPreviewButtonVisible () {\n      return (\n        this.currentTask &&\n        this.currentTask.entity &&\n        this.currentTask.entity.preview_file_id !== this.currentPreviewId &&\n        ['png', 'mp4'].includes(this.extension)\n      )\n    },\n\n    isDlPreviewFile () {\n      return this.currentTaskPreviews &&\n        ['pdf', 'ma', 'mb', 'rar', 'zip'].includes(this.extension)\n    },\n\n    currentTaskType () {\n      if (this.currentTask) {\n        return this.taskTypeMap[this.currentTask.task_type_id]\n      } else {\n        return null\n      }\n    },\n\n    currentPreview () {\n      let currentPreview = this.currentTaskPreviews[0]\n      const previewId = this.route.params.preview_id\n      if (previewId) {\n        currentPreview = this.currentTaskPreviews.find((preview) => {\n          return preview.id === previewId\n        })\n      }\n      return currentPreview\n    },\n\n    currentTeam () {\n      return this.currentProduction.team.map(id => this.personMap[id])\n    },\n\n    pinnedCount () {\n      return this.currentTaskComments.filter(c => c.pinned).length\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'ackComment',\n      'addCommentPreview',\n      'addCommentExtraPreview',\n      'commentTask',\n      'commentTaskWithPreview',\n      'changeCommentPreview',\n      'clearSelectedTasks',\n      'deleteTask',\n      'deleteTaskPreview',\n      'deleteTaskComment',\n      'editTaskComment',\n      'loadEpisodes',\n      'loadTask',\n      'loadShots',\n      'loadAssets',\n      'loadPreviewFileFormData',\n      'loadTaskComments',\n      'loadTaskSubscribed',\n      'refreshPreview',\n      'pinComment',\n      'subscribeToTask',\n      'setCurrentEpisode',\n      'unsubscribeFromTask',\n      'updatePreviewAnnotation'\n    ]),\n\n    getEntityPage () {\n      if (this.currentTask) {\n        const route = {\n          name: this.$route.params.type,\n          params: { production_id: this.currentTask.project_id }\n        }\n\n        if (route.name === 'asset') {\n          route.params.asset_id = this.currentTask.entity_id\n        } else {\n          route.params.shot_id = this.currentTask.entity_id\n        }\n\n        if (this.isTVShow) {\n          route.name = `episode-${route.name}`\n          route.params.episode_id =\n            this.currentEpisode ? this.currentEpisode.id : this.$route.params.episode_id\n        }\n        return route\n      } else {\n        return {\n          name: 'open-productions'\n        }\n      }\n    },\n\n    loadTaskData () {\n      const task = this.getCurrentTask()\n      if (!task) {\n        this.taskLoading = {\n          isLoading: true,\n          isError: false\n        }\n\n        this.loadTask({\n          taskId: this.route.params.task_id,\n          callback: (err, task) => {\n            if (err) console.error(err)\n\n            let loadingFunction = (callback) => {\n              this.loadAssets()\n                .then(callback)\n            }\n\n            if (task.entity_type_name === 'Shot') {\n              loadingFunction = (callback) => {\n                this.loadEpisodes(() => {\n                  if (this.isTVShow) {\n                    this.setCurrentEpisode(task.episode.id)\n                  }\n                  this.loadShots(callback)\n                })\n              }\n            }\n            loadingFunction(() => {\n              this.currentTask = task\n              this.loadTaskComments({\n                taskId: task.id,\n                entityId: task.entity_id,\n                callback: (err) => {\n                  if (err) {\n                    this.taskLoading = {\n                      isLoading: false,\n                      isError: true\n                    }\n                  } else {\n                    this.reset()\n                    this.entityPage = this.getEntityPage()\n                    this.taskLoading = {\n                      isLoading: false,\n                      isError: false\n                    }\n                    this.loadTaskSubscribed({\n                      taskId: this.route.params.task_id,\n                      callback: (err, subscribed) => {\n                        if (err) console.error(err)\n                        this.isSubscribed = subscribed\n                      }\n                    })\n                  }\n                }\n              })\n            })\n          }\n        })\n      } else {\n        this.currentTask = task\n        this.loadTaskComments({\n          taskId: this.route.params.task_id,\n          entityId: task.entity_id,\n          callback: (err) => {\n            if (err) {\n            } else {\n              this.currentTaskComments = this.getCurrentTaskComments()\n              this.currentTaskPreviews = this.getCurrentTaskPreviews()\n              this.setOtherPreviews()\n              this.currentPreviewPath = this.getOriginalPath()\n              this.currentPreviewDlPath = this.getOriginalDlPath()\n              this.entityPage = this.getEntityPage()\n              this.setOtherPreviews()\n              this.loadTaskSubscribed({\n                taskId: this.route.params.task_id,\n                callback: (err, subscribed) => {\n                  if (err) console.error(err)\n                  this.isSubscribed = subscribed\n                }\n              })\n            }\n          }\n        })\n      }\n    },\n\n    isHighlighted (comment) {\n      return comment.preview && comment.preview.id === this.currentPreviewId\n    },\n\n    getCurrentTask () {\n      return this.taskMap[this.route.params.task_id]\n    },\n\n    getCurrentComment () {\n      if (this.route.params.comment_id) {\n        return this.getTaskComment(\n          this.route.params.task_id,\n          this.route.params.comment_id\n        )\n      }\n    },\n\n    getCurrentTaskComments () {\n      return this.getTaskComments(this.route.params.task_id)\n    },\n\n    getCurrentTaskPreviews () {\n      return this.getTaskPreviews(this.route.params.task_id)\n    },\n\n    getCurrentTaskPath () {\n      if (this.currentTask) {\n        return `/tasks/${this.currentTask.id}`\n      } else {\n        return ''\n      }\n    },\n\n    getOriginalPath () {\n      let previewId = this.route.params.preview_id\n      if (!previewId &&\n          this.currentTaskPreviews &&\n          this.currentTaskPreviews.length > 0\n      ) {\n        previewId = this.currentTaskPreviews[0].id\n      }\n      const extension = this.extension ? this.extension : 'png'\n      return `/api/pictures/originals/preview-files/${previewId}.${extension}`\n    },\n\n    getOriginalDlPath () {\n      let previewId = this.route.params.preview_id\n      if (!previewId &&\n          this.currentTaskPreviews &&\n          this.currentTaskPreviews.length > 0\n      ) {\n        previewId = this.currentTaskPreviews[0].id\n      }\n      return `/api/pictures/originals/preview-files/${previewId}/download`\n    },\n\n    getPreviewPath () {\n      let previewId = this.route.params.preview_id\n      if (!previewId &&\n          this.currentTaskPreviews &&\n          this.currentTaskPreviews.length > 0\n      ) {\n        previewId = this.currentTaskPreviews[0].id\n      }\n      return `/api/pictures/previews/preview-files/${previewId}.png`\n    },\n\n    addComment (comment, attachment, checklist, taskStatusId) {\n      const params = {\n        taskId: this.currentTask.id,\n        taskStatusId: taskStatusId,\n        comment: comment,\n        checklist,\n        attachment\n      }\n      let action = 'commentTask'\n      if (this.attachedFileName) action = 'commentTaskWithPreview'\n      this.loading.addComment = true\n      this.errors.addComment = false\n      this.$store.dispatch(action, params)\n        .then(() => {\n          this.$refs['add-preview-modal'].reset()\n          this.reset()\n          this.attachedFileName = ''\n          this.loading.addComment = false\n        })\n        .catch((err) => {\n          console.error(err)\n          this.errors.addComment = true\n          this.loading.addComment = false\n        })\n    },\n\n    reset () {\n      this.currentTaskComments = this.getCurrentTaskComments()\n      this.currentTaskPreviews = this.getCurrentTaskPreviews()\n      this.setOtherPreviews()\n      this.currentPreviewPath = this.getOriginalPath()\n      this.currentPreviewDlPath = this.getOriginalDlPath()\n      this.currentTask = this.getCurrentTask()\n      let previewId = this.route.params.preview_id\n      if (!previewId &&\n          this.currentTaskPreviews &&\n          this.currentTaskPreviews.length > 0) {\n        previewId = this.currentTaskPreviews[0].id\n      }\n      this.currentPreviewId = previewId\n    },\n\n    handleModalsDisplay () {\n      const path = this.$store.state.route.path\n\n      this.modals = {\n        addPreview: false,\n        addExtraPreview: false,\n        deleteExtraPreview: false,\n        deleteTask: false,\n        deleteComment: false,\n        editComment: false\n      }\n      if (\n        path.indexOf('delete') > 0 && path.indexOf('comments') < 0\n      ) {\n        this.modals.deleteTask = true\n      }\n    },\n\n    selectFile (forms) {\n      this.loadPreviewFileFormData(forms)\n      this.attachedFileName = forms\n        .map((form) => form.get('file').name)\n        .join(', ')\n    },\n\n    createPreview () {\n      this.errors.addPreview = false\n      this.loading.addPreview = true\n      this.addCommentPreview({\n        taskId: this.route.params.task_id,\n        commentId: this.route.params.comment_id,\n        callback: (err, preview) => {\n          this.loading.addPreview = false\n          if (err) {\n            this.errors.addPreview = true\n          } else {\n            this.$refs['add-preview-modal'].reset()\n            this.resetPreview(preview)\n          }\n        }\n      })\n    },\n\n    createExtraPreview () {\n      this.errors.addExtraPreview = false\n      this.loading.addExtraPreview = true\n      const previewId = this.currentPreviewId\n      const comment = this.getCurrentTaskComments().find((comment) => {\n        return comment.previews.findIndex((p) => p.id === previewId) >= 0\n      })\n      this.addCommentExtraPreview({\n        taskId: this.currentTask.id,\n        previewId: this.currentPreview.id,\n        commentId: comment.id\n      })\n        .then(() => {\n          this.loading.addExtraPreview = false\n          if (this.currentPreview) {\n            this.resetPreview(this.currentPreview)\n          } else {\n            this.resetPreview({\n              id: previewId\n            })\n          }\n          this.modals.addExtraPreview = false\n          this.$refs['add-extra-preview-modal'].reset()\n          setTimeout(() => {\n            this.$refs['preview-picture'].displayLast()\n          }, 0)\n        })\n        .catch((err) => {\n          console.error(err)\n          this.errors.addExtraPreview = true\n          this.loading.addExtraPreview = false\n        })\n    },\n\n    resetPreview (preview) {\n      this.currentTaskComments = this.getCurrentTaskComments()\n      this.currentTaskPreviews = this.getCurrentTaskPreviews()\n      this.setOtherPreviews()\n      this.currentPreviewPath = this.getOriginalPath()\n      this.currentPreviewDlPath = this.getOriginalDlPath()\n      if (preview) this.$router.push(this.previewPath(preview.id))\n    },\n\n    setPreview () {\n      this.loading.setPreview = true\n      this.errors.setPreview = false\n      this.$store.dispatch('setPreview', {\n        taskId: this.currentTask.id,\n        entityId: this.currentTask.entity.id,\n        previewId: this.currentPreviewId\n      })\n        .then(() => {\n          this.loading.setPreview = false\n        })\n        .catch((err) => {\n          console.error(err)\n          this.errors.setPreview = true\n        })\n    },\n\n    setOtherPreviews () {\n      if (this.currentTaskPreviews) {\n        this.otherPreviews = this.currentTaskPreviews.filter((p) => {\n          return (\n            p.id !== this.currentPreviewId &&\n            p.extension === 'mp4'\n          )\n        })\n      } else {\n        this.otherPreviews = []\n      }\n      return this.otherPreviews\n    },\n\n    confirmDeleteTask () {\n      this.loading.deleteTask = true\n      this.errors.deleteTask = false\n\n      this.deleteTask({\n        task: this.currentTask,\n        callback: (err) => {\n          this.loading.deleteTask = false\n          if (err) {\n            this.errors.deleteTask = true\n          } else {\n            this.$router.push(this.entityPage)\n          }\n        }\n      })\n    },\n\n    confirmEditTaskComment (comment) {\n      this.loading.editComment = true\n      this.errors.editComment = false\n      this.editTaskComment({\n        taskId: this.currentTask.id,\n        comment,\n        callback: (err) => {\n          this.loading.editComment = false\n          if (err) {\n            this.errors.editComment = true\n          } else {\n            this.modals.editComment = false\n          }\n        }\n      })\n    },\n\n    saveComment (comment, checklist) {\n      this.editTaskComment({\n        taskId: this.currentTask.id,\n        comment,\n        checklist\n      })\n    },\n\n    confirmDeleteTaskComment () {\n      this.loading.deleteComment = true\n      this.errors.deleteComment = false\n      const commentId = this.commentToEdit.id\n\n      this.deleteTaskComment({\n        taskId: this.currentTask.id,\n        commentId,\n        callback: (err) => {\n          this.loading.deleteComment = false\n          if (err) {\n            this.errors.deleteComment = true\n          } else {\n            this.reset()\n            if (this.currentTaskPreviews &&\n                this.currentTaskPreviews.length > 0) {\n              this.resetPreview(this.currentTaskPreviews[0])\n            }\n            this.modals.deleteComment = false\n          }\n        }\n      })\n    },\n\n    confirmDeleteTaskPreview () {\n      this.loading.deleteExtraPreview = true\n      this.errors.deleteExtraPreview = false\n      const previewId = this.currentPreviewId\n      const comment = this.getCurrentTaskComments().find((comment) => {\n        return comment.previews.findIndex((p) => p.id === previewId) >= 0\n      })\n\n      this.$refs['preview-picture'].displayFirst()\n      this.deleteTaskPreview({\n        taskId: this.currentTask.id,\n        commentId: comment.id,\n        previewId: this.currentExtraPreviewId\n      })\n        .then(() => {\n          this.loading.deleteExtraPreview = false\n          this.resetPreview(this.currentPreview)\n          this.hideRemoveExtraPreviewModal()\n        })\n        .catch((err) => {\n          console.error(err)\n          this.loading.deleteExtraPreview = false\n          this.errors.deleteExtraPreview = true\n        })\n    },\n\n    onPreviewAdded (eventData) {\n      const taskId = eventData.task_id\n      const commentId = eventData.comment_id\n      const previewId = eventData.preview_file_id\n      const revision = eventData.revision\n      const extension = eventData.extension\n      const comment = this.$store.getters.getTaskComment(taskId, commentId)\n\n      if (\n        this.currentTask &&\n        comment &&\n        (\n          comment.previews.length === 0 ||\n          comment.previews[0].id !== previewId\n        ) &&\n        taskId === this.currentTask.id\n      ) {\n        this.$store.commit('ADD_PREVIEW_END', {\n          preview: {\n            id: previewId,\n            revision,\n            extension: extension\n          },\n          taskId,\n          commentId,\n          comment\n        })\n        if (this.currentPreviewId) {\n          this.resetPreview({ id: this.currentPreviewId })\n        } else {\n          this.resetPreview({ id: previewId })\n        }\n      }\n    },\n\n    toggleSubscribe () {\n      if (this.currentTask && !this.isAssigned) {\n        if (this.isSubscribed) {\n          this.unsubscribeFromTask(this.currentTask.id)\n          this.isSubscribed = false\n        } else {\n          this.subscribeToTask(this.currentTask.id)\n          this.isSubscribed = true\n        }\n      }\n    },\n\n    taskPath (task, section = 'task') {\n      if (!task) {\n        task = this.currentTask\n      } else {\n        task.project_id = this.currentTask.project_id\n        task.episode_id = this.currentTask.episode_id\n      }\n\n      let route = { name: 'open-productions' }\n      if (task) {\n        route = {\n          name: section,\n          params: {\n            production_id: task.project_id,\n            task_id: task.id\n          }\n        }\n\n        if (this.isTVShow && this.currentEpisode) {\n          route.name = `episode-${section}`\n          route.params.episode_id = task.episode_id || this.currentEpisode.id\n        }\n      }\n      return route\n    },\n\n    previewPath (previewId) {\n      const route = this.taskPath(this.currentTask, 'task-preview')\n\n      if (route.params) {\n        route.params.preview_id = previewId\n      }\n      return route\n    },\n\n    onAnnotationChanged ({ preview, annotations }) {\n      const taskId = this.currentTask.id\n      this.updatePreviewAnnotation({ taskId, preview, annotations })\n    },\n\n    onAddExtraPreview () {\n      this.modals.addExtraPreview = true\n    },\n\n    hideExtraPreviewModal () {\n      this.modals.addExtraPreview = false\n    },\n\n    showRemoveExtraPreviewModal (preview) {\n      this.currentExtraPreviewId = preview.id\n      this.modals.deleteExtraPreview = true\n    },\n\n    hideRemoveExtraPreviewModal () {\n      this.modals.deleteExtraPreview = false\n    },\n\n    onAddPreviewClicked () {\n      this.modals.addPreview = true\n    },\n\n    closeAddPreviewModal () {\n      this.modals.addPreview = false\n    },\n\n    onDuplicateComment (comment) {\n      this.$refs['add-comment'].setValue(comment)\n    },\n\n    onPinComment (comment) {\n      this.pinComment(comment)\n    },\n\n    onEditComment (comment) {\n      this.commentToEdit = comment\n      this.modals.editComment = true\n    },\n\n    onDeleteComment (comment) {\n      this.commentToEdit = comment\n      this.modals.deleteComment = true\n    },\n\n    onCancelEditComment (comment) {\n      this.modals.editComment = false\n    },\n\n    onCancelDeleteComment (comment) {\n      this.modals.deleteComment = false\n    },\n\n    onRemoteAcknowledge (eventData, type) {\n      if (this.currentTask) {\n        const comment = this.currentTaskComments.find(\n          c => c.id === eventData.comment_id\n        )\n        const user = this.personMap[eventData.person_id]\n        if (comment && user) {\n          if (this.user.id === user.id) {\n            if (\n              (\n                type === 'ack' &&\n                !comment.acknowledgements.includes(user.id)\n              ) ||\n              (\n                type === 'unack' &&\n                comment.acknowledgements.includes(user.id)\n              )\n            ) {\n              this.$store.commit('ACK_COMMENT', { comment, user })\n            }\n          } else {\n            this.$store.commit('ACK_COMMENT', { comment, user })\n          }\n        }\n      }\n    }\n  },\n\n  watch: {\n    currentPreviewId () {\n      this.setOtherPreviews()\n    },\n\n    $route () {\n      this.handleModalsDisplay()\n      if (this.$route.params.task_id !== this.currentTask.id) {\n        this.loadTaskData()\n      }\n      let previewId = this.route.params.preview_id\n      if (\n        !previewId &&\n        this.currentTaskPreviews &&\n        this.currentTaskPreviews.length > 0\n      ) {\n        previewId = this.currentTaskPreviews[0].id\n      }\n      this.currentPreviewId = previewId\n      this.currentPreviewPath = this.getOriginalPath()\n      this.currentPreviewDlPath = this.getOriginalDlPath()\n    }\n  },\n\n  socket: {\n    events: {\n      'preview-file:add-file' (eventData) {\n        this.onPreviewAdded(eventData)\n      },\n\n      'preview_file:update' (eventData) {\n        const preview = this.currentTaskPreviews.filter((preview) => {\n          return preview.id === eventData.preview_file_id\n        })\n        if (preview) {\n          this.refreshPreview({\n            taskId: this.currentTask.id,\n            previewId: eventData.preview_file_id\n          }).then(() => {\n            if (this.$refs['preview-movie']) {\n              if (!this.$refs['preview-movie'].isDrawing) {\n                this.$refs['preview-movie'].reloadAnnotations()\n              }\n            } else if (this.$refs['preview-picture']) {\n              if (!this.$refs['preview-picture'].isDrawing) {\n                this.$refs['preview-picture'].reset()\n              }\n            }\n          })\n        }\n      },\n\n      'comment:acknowledge' (eventData) {\n        this.onRemoteAcknowledge(eventData, 'ack')\n      },\n\n      'comment:unacknowledge' (eventData) {\n        this.onRemoteAcknowledge(eventData, 'unack')\n      }\n    }\n  },\n\n  metaInfo () {\n    let title = 'Loading task... - Kitsu'\n    if (this.currentTask) {\n      const taskTypeName = this.taskTypeMap[this.currentTask.task_type_id].name\n      title = `${this.title} / ${taskTypeName} - Kitsu`\n    }\n    return { title }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark .page {\n  background: $dark-grey-light;\n  padding-bottom: 1em;\n}\n\n.dark .page-header,\n.dark .add-comment,\n.dark .comment,\n.dark .no-comment,\n.dark .preview-column-content,\n.dark .column {\n  background: #46494F;\n  border-color: $dark-grey;\n  box-shadow: 0px 0px 6px #333;\n}\n\nh2.subtitle {\n  margin: 0;\n  padding: 0;\n}\n\n.page {\n  background: #F9F9F9;\n  margin-top: 60px;\n  padding: 0;\n}\n\n.page-header {\n  padding: 1em;\n  margin-top: 1em;\n  background: white;\n  box-shadow: 0px 0px 6px #E0E0E0;\n  margin: 2em 1em 0 1em;\n}\n\n.navigation-buttons {\n  font-size: 1em;\n  margin-top: 0.5em;\n  margin-bottom: 0.5em;\n}\n\n.navigation-buttons .arrow {\n  font-size: 1.2em;\n  font-weight: bold;\n}\n\n.navigation-buttons a {\n  color: $grey;\n}\n\n.task-information {\n  margin-top: 1em;\n}\n\n.selected {\n  border: 0;\n}\n\n.source {\n  color: #AAA;\n  font-size: 0.8em;\n}\n\nvideo {\n  width: 100%;\n}\n\n.validation-buttons button {\n  width: 100%;\n  margin-bottom: 0.3em;\n  border-width: 2px;\n  font-weight: bold;\n}\n\n.preview-row {\n  margin-bottom: 0.5em;\n}\n\n.add-comment {\n  margin-bottom: 1em;\n  padding: 1em;\n  box-shadow: 0px 0px 6px #E0E0E0;\n}\n\n.no-comment {\n  background: white;\n  box-shadow: 0px 0px 6px #E0E0E0;\n  padding: 1em;\n  border-radius: 5px;\n}\n\n.comment {\n  box-shadow: 0px 0px 6px #E0E0E0;\n  margin-top: 0.3em;\n}\n\n.task-columns {\n  display: flex;\n  flex-direction: row;\n}\n\n.task-column {\n  width: 50%;\n  padding: 1em;\n}\n\n.preview-column-content {\n  background: white;\n  box-shadow: 0px 0px 6px #E0E0E0;\n  padding: 1em;\n  border-radius: 5px;\n  overflow-x: hidden;\n}\n\n.preview-list {\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.page-header .tag {\n  border-radius: 0;\n  font-weight: bold;\n  color: $grey-strong;\n}\n\n.assignees {\n  display: flex;\n}\n\n.assignees span {\n  margin-right: 0.2em;\n}\n\n.preview-picture {\n  text-align: center;\n}\n\n.preview-picture img {\n  max-height: 700px;\n}\n\n.avatar-wrapper {\n  margin-right: 0.5em;\n}\n\n.entity-thumbnail {\n  width: 50px;\n  margin-right: 0.3em;\n}\n\n.title {\n  margin: 0;\n  flex: 1;\n}\n\n.pull-right {\n  margin-left: auto;\n}\n\n.title a {\n  color: inherit;\n}\n\n.set-main-preview {\n  height: 30px;\n}\n\n.back-link {\n  padding-top: 6px;\n}\n\n@media screen and (max-width: 768px) {\n  .action-button {\n    display: none;\n  }\n\n  .title {\n    font-size: 1.3em;\n    line-height: 1.5em;\n  }\n\n  .header-title {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .header-title .flexrow-item {\n    margin-bottom: 0.5em;\n  }\n\n  .task-columns {\n    flex-direction: column-reverse;\n  }\n\n  .task-column {\n    width: 100%;\n    overflow-y: initial;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Task.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Task.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Task.vue?vue&type=template&id=7fbc429d&scoped=true&\"\nimport script from \"./Task.vue?vue&type=script&lang=js&\"\nexport * from \"./Task.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Task.vue?vue&type=style&index=0&id=7fbc429d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7fbc429d\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('router-link',{staticClass:\"button\",attrs:{\"title\":_vm.title,\"to\":_vm.path}},[(_vm.icon.length > 0 && _vm.icon.startsWith('fa'))?_c('span',{staticClass:\"icon is-small\"},[_c('i',{class:'fa ' + _vm.icon})]):_vm._e(),(_vm.icon === 'plus')?_c('plus-icon',{class:{\n      icon: true,\n      'is-small': true,\n      'only-icon': !_vm.isText\n    }}):_vm._e(),(_vm.icon === 'download')?_c('download-icon',{class:{\n      icon: true,\n      'is-small': true,\n      'only-icon': !_vm.isText\n    }}):_vm._e(),(_vm.icon === 'upload')?_c('upload-icon',{class:{\n      icon: true,\n      'is-small': true,\n      'only-icon': !_vm.isText\n    }}):_vm._e(),(_vm.icon === 'edit')?_c('edit-icon',{class:{\n      icon: true,\n      'is-small': true,\n      'only-icon': !_vm.isText\n    }}):_vm._e(),(_vm.icon === 'delete')?_c('trash-icon',{class:{\n      icon: true,\n      'is-small': true,\n      'only-icon': !_vm.isText\n    }}):_vm._e(),(_vm.icon === 'restore')?_c('rotate-ccw-icon',{class:{\n      icon: true,\n      'is-small': true,\n      'only-icon': !_vm.isText\n    }}):_vm._e(),(_vm.isText)?_c('span',{class:{\n      text: true,\n      'is-hidden-touch': _vm.isResponsive\n    }},[_vm._v(\" \"+_vm._s(_vm.text)+\" \")]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<router-link\n  class=\"button\"\n  :title=\"title\"\n  :to=\"path\"\n>\n  <span class=\"icon is-small\" v-if=\"icon.length > 0 && icon.startsWith('fa')\">\n    <i :class=\"'fa ' + icon\"></i>\n  </span>\n  <plus-icon\n    :class=\"{\n      icon: true,\n      'is-small': true,\n      'only-icon': !isText\n    }\" v-if=\"icon === 'plus'\" />\n  <download-icon\n    :class=\"{\n      icon: true,\n      'is-small': true,\n      'only-icon': !isText\n    }\" v-if=\"icon === 'download'\" />\n  <upload-icon\n    :class=\"{\n      icon: true,\n      'is-small': true,\n      'only-icon': !isText\n    }\" v-if=\"icon === 'upload'\" />\n  <edit-icon\n    :class=\"{\n      icon: true,\n      'is-small': true,\n      'only-icon': !isText\n    }\" v-if=\"icon === 'edit'\" />\n  <trash-icon\n    :class=\"{\n      icon: true,\n      'is-small': true,\n      'only-icon': !isText\n    }\" v-if=\"icon === 'delete'\" />\n  <rotate-ccw-icon\n    :class=\"{\n      icon: true,\n      'is-small': true,\n      'only-icon': !isText\n    }\" v-if=\"icon === 'restore'\" />\n\n  <span\n    :class=\"{\n      text: true,\n      'is-hidden-touch': isResponsive\n    }\"\n    v-if=\"isText\"\n  >\n    {{ text }}\n  </span>\n</router-link>\n</template>\n\n<script>\nimport {\n  DownloadIcon,\n  EditIcon,\n  PlusIcon,\n  RotateCcwIcon,\n  TrashIcon,\n  UploadIcon\n} from 'vue-feather-icons'\n\nexport default {\n  name: 'button-link',\n  components: {\n    DownloadIcon,\n    EditIcon,\n    PlusIcon,\n    RotateCcwIcon,\n    TrashIcon,\n    UploadIcon\n  },\n  props: {\n    text: {\n      default: '',\n      type: String\n    },\n    title: {\n      default: '',\n      type: String\n    },\n    path: {\n      default: ''\n    },\n    icon: {\n      default: '',\n      type: String\n    },\n    isResponsive: {\n      default: false,\n      type: Boolean\n    }\n  },\n  computed: {\n    isText () {\n      return this.text && this.text.length > 0\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.button .icon.is-small.only-icon {\n  margin-right: 0;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ButtonLink.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ButtonLink.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ButtonLink.vue?vue&type=template&id=143e1424&scoped=true&\"\nimport script from \"./ButtonLink.vue?vue&type=script&lang=js&\"\nexport * from \"./ButtonLink.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ButtonLink.vue?vue&type=style&index=0&id=143e1424&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"143e1424\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}