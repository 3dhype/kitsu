(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76b90d3a"],{1981:function(t,e,a){"use strict";var o=a("6d17"),r=a.n(o);r.a},"26a2":function(t,e,a){},"687f":function(t,e,a){},"6d17":function(t,e,a){},a9a2:function(t,e,a){"use strict";var o=a("687f"),r=a.n(o);r.a},c82e:function(t,e,a){"use strict";var o=a("26a2"),r=a.n(o);r.a},cd92:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"columns fixed-page"},[a("div",{staticClass:"column main-column"},[a("div",{staticClass:"flexrow filters"},[a("div",{staticClass:"flexrow-item"},[a("combobox-task-type",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.type_label"),"task-type-list":t.shotTaskTypes},model:{value:t.taskTypeId,callback:function(e){t.taskTypeId=e},expression:"taskTypeId"}})],1),a("div",{staticClass:"flexrow-item"},[a("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.detail_label"),options:t.detailLevelOptions},model:{value:t.detailLevelString,callback:function(e){t.detailLevelString=e},expression:"detailLevelString"}})],1),"day"===t.detailLevelString?a("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.month_label"),options:t.monthOptions},model:{value:t.monthString,callback:function(e){t.monthString=e},expression:"monthString"}}):t._e(),a("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.year_label"),options:t.yearOptions},model:{value:t.yearString,callback:function(e){t.yearString=e},expression:"yearString"}}),a("div",{staticClass:"flexrow-item"},[a("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.count_label"),options:t.countModeOptions},model:{value:t.countMode,callback:function(e){t.countMode=e},expression:"countMode"}})],1)],1),a("quota",{attrs:{taskTypeId:t.taskTypeId,detailLevel:t.detailLevelString,year:t.currentYear,month:t.currentMonth,week:t.currentWeek,day:t.currentDay,currentPerson:t.currentPerson,countMode:t.currentMode}})],1),t.showInfo?a("div",{staticClass:"column side-column"},[a("people-quota-info",{attrs:{person:t.currentPerson,year:t.currentYear,month:t.currentMonth,week:t.currentWeek,day:t.currentDay,"is-loading":!1,"is-loading-error":!1,shots:t.personShots,"count-mode":t.countMode},on:{close:t.hideSideInfo}})],1):t._e()])},r=[],n=(a("a4d3"),a("4de4"),a("4160"),a("c975"),a("d81d"),a("a9e3"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),s=a("7f45"),i=a.n(s),c=a("3657"),u=a("2f62"),l=a("992f"),d=a("e4fd"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"quota"},[this.quotaLength>0&&!t.isLoading?a("div",{staticClass:"quota-fixed"},[a("div",{staticClass:"quota-header quota-row"},[a("div",{staticClass:"header-cell row-cell row-cell--name"},[t._v(" "+t._s(t.$t("quota.name"))+" ")]),a("div",{staticClass:"header-cell row-cell row-cell--average"},[t._v(" "+t._s(t.$t("quota.average"))+" ")])]),t._l(t.personIds,(function(e){return a("div",{key:"name-"+e,staticClass:"quota-row"},[a("div",{staticClass:"row-cell row-cell--name"},[a("people-avatar",{attrs:{size:30,person:t.personMap[e]}}),t._v(" "+t._s(t.personMap[e].full_name)+" ")],1),"month"===t.detailLevel?a("div",{staticClass:"row-cell row-cell--average"},[t._v(" "+t._s(t.getQuotaAverage(e,{year:t.year}))+" ")]):t._e(),"week"===t.detailLevel?a("div",{staticClass:"row-cell row-cell--average"},[t._v(" "+t._s(t.getQuotaAverage(e,{year:t.year}))+" ")]):t._e(),"day"===t.detailLevel?a("div",{staticClass:"row-cell row-cell--average"},[t._v(" "+t._s(t.getQuotaAverage(e,{year:t.year,month:t.month}))+" ")]):t._e()])}))],2):t._e(),this.quotaLength>0&&!t.isLoading?a("div",{ref:"body",staticClass:"quota-scrolled"},[a("div",{staticClass:"quota-header quota-row"},[t._l(t.monthRange,(function(e){return"month"===t.detailLevel?a("div",{key:"month-"+e,staticClass:"header-cell row-cell"},[t._v(" "+t._s(t.monthToString(e))+" ")]):t._e()})),t._l(t.weekRange,(function(e){return"week"===t.detailLevel?a("div",{key:"week-"+e,staticClass:"header-cell row-cell"},[t._v(" "+t._s(e)+" ")]):t._e()})),t._l(t.dayRange,(function(e){return"day"===t.detailLevel?a("div",{key:"day-"+e,staticClass:"header-cell row-cell"},[t._v(" "+t._s(e)+" ")]):t._e()}))],2),t._l(t.personIds,(function(e){return a("div",{key:e,staticClass:"quota-row"},[t._l(t.monthRange,(function(o){return"month"===t.detailLevel?a("div",{key:"month-"+o,class:{"row-cell":!0,selected:t.isMonthSelected(e,t.year,o)}},[t.getQuota(e,{year:t.year,month:o})?a("router-link",{staticClass:"quota-button",attrs:{to:t.episodifyRoute({name:"quota-month-person",params:{person_id:e,year:t.year,month:o}})}},[t._v(" "+t._s(t.getQuota(e,{year:t.year,month:o}))+" ")]):a("span",[t._v("-")])],1):t._e()})),t._l(t.weekRange,(function(o){return"week"===t.detailLevel?a("div",{key:"week-"+o,class:{"row-cell":!0,selected:t.isWeekSelected(e,t.year,o)}},[t.getQuota(e,{year:t.year,week:o})?a("router-link",{staticClass:"quota-button",attrs:{to:t.episodifyRoute({name:"quota-week-person",params:{person_id:e,year:t.year,week:o}})}},[t._v(" "+t._s(t.getQuota(e,{year:t.year,week:o}))+" ")]):a("span",[t._v(" - ")])],1):t._e()})),t._l(t.dayRange,(function(o){return"day"===t.detailLevel?a("div",{key:"day-"+o,class:{"row-cell":!0,weekend:t.isWeekend(t.year,t.month,o),selected:t.isDaySelected(e,t.year,t.month,o)}},[t.getQuota(e,{year:t.year,month:t.month,day:o})?a("router-link",{staticClass:"quota-button",attrs:{to:t.episodifyRoute({name:"quota-day-person",params:{person_id:e,year:t.year,month:t.month,day:o}})}},[t._v(" "+t._s(t.getQuota(e,{year:t.year,month:t.month,day:o}))+" ")]):a("span",[t._v(" - ")])],1):t._e()}))],2)}))],2):t._e(),0!==this.quotaLength||t.isLoading?t._e():a("div",{staticClass:"has-text-centered empty-quota"},[a("p",{staticClass:"info"},[t._v(t._s(t.$t("quota.no_quota")))])]),a("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}})],1)},p=[],y=(a("99af"),a("caad"),a("b680"),a("d3b7"),a("25f0"),a("4d90"),a("9d8b")),f=a("eb8c"),m=a("e60b");function v(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function b(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?v(Object(a),!0).forEach((function(e){Object(n["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var g={name:"quota",components:{PeopleAvatar:f["a"],TableInfo:m["a"]},props:{taskTypeId:{type:String,required:!0},detailLevel:{type:String,default:"day",required:!0},countMode:{type:String,default:"frames",required:!0},year:{type:Number,default:0},month:{type:Number,default:0},week:{type:Number,default:0},day:{type:Number,default:0}},data:function(){return{currentMonth:i()().month()+1,currentYear:i()().year(),currentWeek:i()().week(),detailsTitle:"",detailsMap:{},isPanelShown:!1,isLoading:!1,isError:!1,quotaMap:{},quotaLength:0,selected:void 0}},mounted:function(){this.loadData()},computed:b({},Object(u["c"])(["currentEpisode","shotMap","personMap"]),{monthRange:function(){return Object(c["f"])(this.year,this.currentYear,this.currentMonth)},dayRange:function(){return Object(c["b"])(this.year,this.month,this.currentYear,this.currentMonth)},weekRange:function(){return Object(c["h"])(this.year,this.currentYear,this.currentWeek)},personIds:function(){var t=this,e=Object.keys(this.quotaMap);return e.sort((function(e,a){var o=t.personMap[e].full_name,r=t.personMap[a].full_name;return o.localeCompare(r)}))}}),methods:b({},Object(u["b"])(["loadShots","computeQuota","getPeriodDetails"]),{episodifyRoute:function(t){return this.currentEpisode&&Object(y["a"])(t,this.currentEpisode.id),t},isWeekend:function(t,e,a){var o=i()("".concat(t,"-").concat(e,"-").concat(a));return a<10&&(o=i()("".concat(t,"-").concat(e,"-0").concat(a))),[0,6].includes(o.day())},loadData:function(){var t=this;this.taskTypeId&&this.computeQuota({taskTypeId:this.taskTypeId,detailLevel:this.detailLevel,countMode:this.countMode}).then((function(e){t.quotaMap=e,t.isLoading=!1,t.quotaLength=Object.keys(t.quotaMap).length}))},loadDetails:function(t,e){var a=this;this.loadShots((function(o){a.isLoading=!0,o?console.error(o):a.taskTypeId&&a.getPeriodDetails({taskTypeId:a.taskTypeId,detailLevel:a.detailLevel,personId:t,dateString:e}).then((function(t){a.detailsMap=t,a.isLoading=!1}))}))},monthToString:c["i"],getQuota:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.day){var a="".concat(e.year,"-").concat(e.month.toString().padStart(2,"0"),"-").concat(e.day);return this.quotaMap[t][a]}if(e.week){var o="".concat(e.year,"-").concat(e.week);return this.quotaMap[t][o]}var r="".concat(e.year,"-").concat(e.month.toString().padStart(2,"0"));return this.quotaMap[t][r]},getQuotaAverage:function(t){var e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a.month){var o=a.year+"-"+a.month.toString().padStart(2,"0");e=this.quotaMap[t].average[o]}else if(a.week){var r="".concat(a.year,"-").concat(a.week);e=this.quotaMap[t].average[r]}else this.quotaMap[t].average&&(e=this.quotaMap[t].average[a.year]);return e?e.toFixed(2):"-"},isDaySelected:function(t,e,a,o){return this.$route.params.person_id&&this.$route.params.person_id===t&&this.$route.params.year===e&&this.$route.params.month===a&&this.$route.params.day===o},isWeekSelected:function(t,e,a){return this.$route.params.person_id&&this.$route.params.person_id===t&&this.$route.params.year===e&&this.$route.params.week===a},isMonthSelected:function(t,e,a){return this.$route.params.person_id&&this.$route.params.person_id===t&&this.$route.params.year===e&&this.$route.params.month===a}}),watch:{taskTypeId:function(){this.taskTypeId&&this.loadData()},detailLevel:function(){this.loadData()},countMode:function(){this.loadData()},shotMap:function(){this.loadData()},$route:function(){var t=this,e=document.getElementsByClassName("selected");0===e.length&&setTimeout((function(){t.$refs.body.scrollLeft+=380}),100)}}},k=g,w=(a("c82e"),a("2877")),O=Object(w["a"])(k,h,p,!1,null,"18ef0a52",null),_=O.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"people-timesheet-info"},[a("div",{staticClass:"close"},[a("router-link",{staticClass:"close-button",attrs:{to:t.closeRoute}},[a("x-icon")],1)],1),a("div",{staticClass:"flexrow"},[a("people-avatar",{staticClass:"flexrow-item",attrs:{person:t.person,"no-cache":!0}}),a("page-title",{staticClass:"flexrow-item",attrs:{text:t.person.full_name}})],1),t.isMonthInfo?a("div",{staticClass:"info-date"},[t._v(" "+t._s(t.monthString)+" "+t._s(t.year)+" ")]):t.isWeekInfo?a("div",{staticClass:"info-date"},[t._v(" week "+t._s(t.week)+", "+t._s(t.startDay)+" - "+t._s(t.endDay)+" "+t._s(t.weekMonth)+" "+t._s(t.year)+" ")]):t.isDayInfo?a("div",{staticClass:"info-date"},[t._v(" "+t._s(t.day)+" "+t._s(t.monthString)+" "+t._s(t.year)+" ")]):t._e(),a("quota-shot-list",{staticClass:"time-spent-list",attrs:{"count-mode":t.countMode,shots:t.shots,"is-loading":t.isLoading,"is-error":t.isLoadingError}})],1)},S=[],q=(a("b0c0"),a("0a35")),j=a("8d07"),L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"data-list"},[t.isLoading?t._e():a("table",{staticClass:"details table"},[a("thead",[a("tr",[a("th",[t._v(t._s(t.$t("quota.details_name")))]),a("th",[t._v(" "+t._s("seconds"===this.countMode?t.$t("quota.details_seconds"):t.$t("quota.details_frames"))+" ")])])]),a("tbody",t._l(t.shots,(function(e){return a("tr",{key:"shot-quota-"+e.id},[a("td",[t._v(t._s(e.full_name))]),a("td",[t._v(t._s(t.getQuota(e)))])])})),0)]),a("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isLoadingError}})],1)},P=[],C=a("bcd2");function I(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function $(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?I(Object(a),!0).forEach((function(e){Object(n["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var x={name:"quota-shot-list",components:{TableInfo:m["a"]},data:function(){return{projectNames:{}}},props:{shots:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isLoadingError:{type:Boolean,default:!1},countMode:{type:String,default:"frames"}},computed:$({},Object(u["c"])(["currentProduction","lastProductionScreen","taskTypeMap"])),methods:$({},Object(u["b"])([]),{getQuota:function(t){return"seconds"===this.countMode?Object(C["a"])(t.nb_frames,this.currentProduction,t):t.nb_frames}}),watch:{}},T=x,D=(a("1981"),Object(w["a"])(T,L,P,!1,null,"b0f1b008",null)),E=D.exports;function R(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function Q(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?R(Object(a),!0).forEach((function(e){Object(n["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var N={name:"shot-quota-info",components:{XIcon:q["M"],PageTitle:j["a"],PeopleAvatar:f["a"],QuotaShotList:E},props:{person:{type:Object,default:function(){}},year:{type:Number,default:0},month:{type:Number,default:0},week:{type:Number,default:0},day:{type:Number,default:0},countMode:{type:String,default:"frames"},isLoading:{type:Boolean,default:!1},isLoadingError:{type:Boolean,default:!1},shots:{type:Array,default:function(){return[]}}},computed:Q({},Object(u["c"])(["currentEpisode","currentProduction"]),{startDay:function(){return i()().day("Monday").year(this.year).week(this.week).date()},endDay:function(){return i()().day("Monday").year(this.year).week(this.week).add("days",6).date()},weekMonth:function(){return i()().day("Monday").year(this.year).week(this.week).format("MMM")},monthString:function(){return Object(c["i"])(this.month)},isMonthInfo:function(){return this.$route.path.indexOf("month")>0},isWeekInfo:function(){return this.$route.path.indexOf("week")>0},isDayInfo:function(){return this.$route.path.indexOf("day")>0},closeRoute:function(){if(!this.currentProduction)return{};var t={name:"quota",production_id:this.currentProduction.id};return this.isMonthInfo?t={name:"quota-month",params:{year:this.year}}:this.isWeekInfo?t={name:"quota-week",params:{year:this.year}}:this.isDayInfo&&(t={name:"quota-day",params:{year:this.year,month:this.month}}),this.currentEpisode&&(t.name="episode-".concat(t.name),t.params.episode_id=this.currentEpisode.id),t}}),methods:Q({},Object(u["b"])([]),{onCloseClicked:function(){this.$emit("close")}})},W=N,Y=(a("a9a2"),Object(w["a"])(W,M,S,!1,null,"5ef21a06",null)),A=Y.exports;function B(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function F(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?B(Object(a),!0).forEach((function(e){Object(n["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var J={name:"production-quota",components:{Combobox:l["a"],ComboboxTaskType:d["a"],PeopleQuotaInfo:A,Quota:_},data:function(){return{taskTypeId:"",countMode:"frames",countModeOptions:[{label:"Frames",value:"frames"},{label:"Seconds",value:"seconds"}],detailLevelOptions:[{label:"Day",value:"day"},{label:"Week",value:"week"},{label:"Month",value:"month"}],currentYear:i()().year(),currentMonth:i()().month()+1,currentWeek:i()().week(),currentDay:i()().date(),currentPerson:this.getCurrentPerson(),currentMode:"frames",detailLevelString:"day",detailLevel:"day",isLoading:!1,isLoadingError:!1,monthString:"".concat(i()().month()+1),personShots:[],showInfo:!1,yearString:"".concat(i()().year())}},mounted:function(){this.loadRoute()},computed:F({},Object(u["c"])(["currentEpisode","currentProduction","shotTaskTypes","personMap"]),{yearOptions:function(){var t=2018,e=i()().year();return Object(c["j"])(t,e).map((function(t){return{label:t,value:"".concat(t)}}))},monthOptions:function(){var t="".concat(i()().year()),e=1,a=i()().month()+1,o=Object(c["j"])(e,12);return t===this.yearString&&(o=Object(c["j"])(e,a)),o.map((function(t){return{label:Object(c["i"])(t),value:"".concat(t)}}))}}),methods:F({},Object(u["b"])(["computeQuota","getPersonShots","loadShots"]),{getCurrentPerson:function(){var t=this.$route.params.person_id;return t&&this.personMap?this.personMap[t]:{}},loadRoute:function(){var t=this,e=this.$route.params,a=e.month,o=e.year,r=e.week,n=e.day,s=this.$route.query,i=s.countMode,c=s.taskTypeId;if(this.$route.path.indexOf("week")>0&&(this.detailLevel="week"),this.$route.path.indexOf("month")>0&&(this.detailLevel="month"),this.$route.path.indexOf("day")>0&&(this.detailLevel="day"),this.currentPerson=this.getCurrentPerson(),this.detailLevelString=this.detailLevel,i&&(this.countMode=i,this.currentMode=this.countMode),c)this.taskTypeId=c;else{var u="quota:".concat(this.currentProduction.id,":task-type-id");this.taskTypeId=localStorage.getItem(u)||this.shotTaskTypes[0].id}a&&(this.currentMonth=Number(a),this.monthString="".concat(a)),o&&(this.currentYear=Number(o),this.yearString="".concat(o)),r&&(this.currentWeek=Number(r),this.weekString="".concat(r)),n&&(this.currentDay=Number(n)),this.$route.path.indexOf("person")>0?this.getPersonShots({personId:this.currentPerson.id,detailLevel:this.detailLevel,taskTypeId:this.taskTypeId,year:o,month:a,week:r,day:n}).then((function(e){t.personShots=e,t.showSideInfo()})):this.hideSideInfo()},showSideInfo:function(){this.showInfo=!0},hideSideInfo:function(){this.showInfo=!1}}),watch:{detailLevelString:function(){this.detailLevel!==this.detailLevelString&&("month"===this.detailLevelString?this.$router.push({name:"quota-month",params:{year:this.currentYear},query:{countMode:this.countMode}}):"week"===this.detailLevelString?this.$router.push({name:"quota-week",params:{year:this.currentYear},query:{countMode:this.countMode}}):"day"===this.detailLevelString&&this.$router.push({name:"quota-day",params:{year:this.currentYear,month:this.currentMonth},query:{countMode:this.countMode}}))},yearString:function(){var t=Number(this.yearString),e=i()().month()+1;this.currentYear!==t&&("month"===this.detailLevel?this.$router.push({name:"quota-month",params:{year:t},query:{countMode:this.countMode}}):"week"===this.detailLevel?this.$router.push({name:"quota-week",params:{year:t},query:{countMode:this.countMode}}):this.$router.push({name:"quota-day",params:{year:t,month:Math.min(Number(this.monthString),e)},query:{countMode:this.countMode}}))},monthString:function(){this.currentMonth!==Number(this.monthString)&&this.$router.push({name:"quota-day",params:{year:this.currentYear,month:Number(this.monthString)},query:{countMode:this.countMode}})},countMode:function(){this.currentMode!==this.countMode&&(this.$router.push({query:{countMode:this.countMode}}),this.currentMode=this.countMode)},taskTypeId:function(){var t="quota:".concat(this.currentProduction.id,":task-type-id");localStorage.setItem(t,this.taskTypeId),this.$router.push({query:{taskTypeId:this.taskTypeId}})},currentProduction:function(){var t=this;this.isLoading=!0,this.loadShots((function(){t.loadRoute(),t.isLoading=!1}))},currentEpisode:function(){var t=this;this.isLoading=!0,this.loadShots((function(){t.loadRoute(),t.isLoading=!1}))},$route:function(){this.loadRoute()}}},z=J,X=(a("ce69"),Object(w["a"])(z,o,r,!1,null,"6e24cf3e",null));e["default"]=X.exports},ce69:function(t,e,a){"use strict";var o=a("efd1"),r=a.n(o);r.a},efd1:function(t,e,a){}}]);
//# sourceMappingURL=chunk-76b90d3a.802ba028.js.map